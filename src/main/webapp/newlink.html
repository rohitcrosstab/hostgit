<!DOCTYPE html>
<html>
<head>
<title>Org Chart | CrossTAB</title>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport"
	content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1">
<!--Loading bluebird js for IE promise -->
<script src="script/bluebird.js"></script>
<!--Loading bootstrap css-->
<link rel="stylesheet" href="styles/pace.css" />
<link href="https://fonts.googleapis.com/css?family=Sintony:400,700"
	rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=PT+Sans:400,700"
	rel="stylesheet">
<link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css" />
<link type="text/css" rel="stylesheet"
	href="styles/jquery-ui-1.10.4.custom.min.css" />
<link type="text/css" rel="stylesheet"
	href="styles/font-awesome.min.css">
<link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css" />
<link type="text/css" rel="stylesheet" href="styles/animate.css" />
<link type="text/css" rel="stylesheet" href="styles/all.css" />
<link type="text/css" rel="stylesheet" href="styles/main.css" />
<link type="text/css" rel="stylesheet"
	href="styles/style-responsive.css" />
<link type="text/css" rel="stylesheet"
	href="styles/zabuto_calendar.min.css" />
<link rel="stylesheet" href="styles/minimal/grey.css" />
<link rel="stylesheet" type="text/css" href="styles/jquery-ui.css" />

<link rel="stylesheet" href="styles/Treant.css" />
<link rel="stylesheet" href="styles/collapsable.css" />
<link rel="stylesheet" href="styles/perfect-scrollbar.css" />

<link rel="stylesheet" href="styles/square/grey.css" />
<link rel="stylesheet" href="styles/jquery.auto-complete.css" />

<link rel="stylesheet" href="styles/jquery.jscrollpane.css" />

<link rel="stylesheet" href="styles/tooltipster.bundle.min.css" />
<link rel="stylesheet" href="styles/tooltipster-sideTip-shadow.min.css" />

<style>
.modal {
	text-align: center;
}

@media screen and (min-width: 768px) {
	.modal:before {
		display: inline-block;
		vertical-align: middle;
		content: " ";
		height: 100%;
	}
}

.modal-dialog {
	display: inline-block;
	text-align: left;
	vertical-align: middle;
}

#divLoading {
	display: none;
}

#divLoading.show {
	display: block;
	position: fixed;
	z-index: 104;
	background-image:
		url("/JubilantOrgChartProject/images/bg/loadinggif.gif");
	background-color: #666;
	opacity: 0.4;
	background-repeat: no-repeat;
	background-position: center;
	left: 0;
	bottom: 0;
	right: 0;
	top: 0;
}

#loadinggif.show {
	left: 50%;
	top: 50%;
	position: absolute;
	z-index: 101;
	width: 32px;
	height: 32px;
	margin-left: -16px;
	margin-top: -16px;
}

.ui-slider-horizontal {
	height: .3em;
}

.ui-slider.ui-slider-horizontal .ui-slider-handle {
	top: -0.6em;
}

.ui-widget-content .ui-state-default:hover, .ui-widget-content .ui-state-default:focus
	{
	background: #bdbdbd;
}
</style>

</head>

<body>

	<!--BEGIN BACK TO TOP-->
	<a id="totop" href="#"><i class="fa fa-angle-up"></i></a>
	<!--END BACK TO TOP-->
	<!--BEGIN TOPBAR-->
	<div id="header-topbar-option-demo" class="page-header-topbar">

		<div
			style="width: 100%; display: inline-block; background: #4d87b3; height: 2.2em;">
			<!--  
			<div
				style="margin-left: 1%; width: 5%; display: inline-block; color: #ffffff; font-family: Tahoma; font-size: 1.8em;">
				<img src="/JubilantOrgChartProject/images/bg/jubilant_logo.png"
					style="width: 1.8em; height: 1.2em;">
			</div>
				-->
			<div
				style="margin-left: 1%; width: 10%; display: inline-block; color: #ffffff; font-family: Tahoma; font-size: 1.2em; position: absolute; top: 0.5%;">OrgChart</div>

			<div id="searchIcon"
				style="position: absolute; left: 13.5em;
	/* width: 2%; */ display: inline-block; color: #ffffff; font-family: Tahoma; font-size: 1.2em; margin-top: 0.05em; display: none;">
				<i class="fa fa-search"></i>
			</div>
			<div
				style="margin-left: 5%; width: 40%; height: 100%; color: #FFFFFF; display: inline-block;">
				<input type="text" id="searchBox"
					placeholder="Search by Employee Name/Designation.."
					style="font-family: Tahoma; font-size: 0.9em; height: 2.4em; padding-left: 1em; background: #2a485f; border: 0 !important; top: 0; width: 40%; top: 0; left: 17%; position: absolute; display: none;" />
			</div>
			<div
				style="font-family: Tahoma; margin-left: 30%; height: 100%; display: inline-block;">
			</div>

		</div>
	</div>

	<!--BEGIN MODAL CONFIG PORTLET-->
	<div id="downloadModal" class="modal fade">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" data-dismiss="modal" aria-hidden="true"
						class="close">&times;</button>
					<h4 style="color: #2c2c2c;">
						<i class="fa fa-save"></i>&nbsp;&nbsp;&nbsp;Export As..
					</h4>
				</div>
				<div class="modal-body" style="text-align: center;">

					<div id="exportLoadingDiv" align="center" style="display: none;">
						<img src="/JubilantOrgChartProject/images/bg/gears.gif"></img> <br>
						<br> <span id="exportLoadingMessage">Please Wait..</span>
					</div>

					<div id="exportButtonsDiv">
						<button type="button" class="btn btn-blue btn-sm"
							id="downloadImage">
							<i class="fa fa-image"></i>&nbsp;JPEG
						</button>
						<!--
						&nbsp;&nbsp;&nbsp;
						<button type="button" class="btn btn-blue btn-sm"
							id="downloadPDF2">
							<i class="fa fa-file-pdf-o"></i>&nbsp;PDF
						</button> 
						-->
						&nbsp;&nbsp;&nbsp;
						<button type="button" class="btn btn-blue btn-sm" id="downloadPPT">
							<i class="fa fa-file-powerpoint-o"></i>&nbsp;PPT
						</button>
						<!-- 
						&nbsp;&nbsp;&nbsp;
						<button type="button" class="btn btn-blue btn-sm"
							id="directToPrinter">
							<i class="fa fa-print"></i>&nbsp;Printer
						</button>
						-->
						<br> <br> <span><b>NOTE:&nbsp;</b>PPTs are
							downloaded without photos.</span>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!--END TOPBAR-->
	<div id="wrapper" style="background-color: #EEEEEE">
		<!--BEGIN SIDEBAR MENU-->

		<!--END SIDEBAR MENU-->
		<!--BEGIN PAGE WRAPPER-->
		<!--BEGIN CONTENT-->
		<div class="page-content" align="center">
			<div style="width: 100%; background: #eee;">
				<div id="tabView">
					<ul class="nav nav-tabs">
						<li id="orgchart_li"><a data-target="#orgchartpanel"
							class="orgchartview"
							style="font-size: 0.8em; font-family: Tahoma;"><i
								class="fa fa-sitemap"></i>&emsp;C H A R T&emsp;</a></li>
						<li><a data-target="#listviewpanel" class="listview"
							style="font-size: 0.8em; font-family: Tahoma;"><i
								class="fa fa-list-ul"></i>&emsp;L I S T&emsp;</a></li>
					</ul>
					<div class="panels">
						<div id="orgchartpanel" style="background: #FFFFFF;">
							<div id="orgchartButtonsDiv"
								style="width: 100%; background: #FFFFFF;" align="center">

								<div id="orgChartFilters" align="center"
									style="background: #FFFFFF; width: 14em; opacity: 0.6; overflow: hidden; border: 0.15em solid #d3d3d3; -webkit-border-radius: 1.2em; -moz-border-radius: 1.2em; border-radius: 1.2em; position: absolute; z-index: 103; transform: translate(0%, 20%); -webkit-transform: translate(0%, 20%);"
									align="left">
									<div id="showFiltersDiv"
										style="margin-top: 0.2em; margin-bottom: 0.2em;">
										<a href="javascript:void(0)" id="showFilters"
											style="color: #2c2c2c; font-size: 0.85em; font-weight: bold; font-family: Tahoma;"><i
											class="fa fa-filter" id="filterIcon1"></i>&nbsp;&nbsp;M E N
											U&nbsp;&nbsp;&nbsp;<i class="fa fa-angle-down"></i> </a>
									</div>
									<div id="hideFiltersDiv"
										style="margin-top: 0.2em; margin-bottom: 0.2em; display: none;">
										<a href="javascript:void(0)" id="hideFilters"
											style="color: #2c2c2c; font-size: 0.85em; font-weight: bold; font-family: Tahoma;"><i
											class="fa fa-filter" id="filterIcon2"></i>&nbsp;&nbsp;M E N
											U&nbsp;&nbsp;&nbsp;<i class="fa fa-angle-up"></i> </a>
									</div>
									<div id="filtersContent"
										style="font-size: 0.7em; color: #000; text-align: left; margin: 1em 3em; display: block; display: none;">
										<div class="form-group">
											<div class="checkbox"
												style="margin-left: 1em; margin-top: 1em;">
												<label><input class="icheckbox" type="checkbox"
													id="nodeName" checked />&nbsp;&nbsp;Name</label>
											</div>
											<div class="checkbox"
												style="margin-left: 1em; margin-top: 0.5em;">
												<label><input class="icheckbox" type="checkbox"
													id="nodeDP" checked />&nbsp;&nbsp;Photos</label>
											</div>
											<!-- 
											<div class="checkbox"
												style="margin-left: 1em; margin-top: 0.5em;">
												<label><input class="icheckbox" type="checkbox"
													id="nodeTitle" checked />&nbsp;&nbsp;Designation</label>
											</div>
											 -->
											<div class="checkbox"
												style="margin-left: 1em; margin-top: 0.5em;">
												<label><input class="icheckbox" type="checkbox"
													id="nodeDept" />&nbsp;&nbsp;Department</label>
											</div>
											<div class="checkbox"
												style="margin-left: 1em; margin-top: 0.5em;">
												<label><input class="icheckbox" type="checkbox"
													id="nodeGrade" />&nbsp;&nbsp;Grade</label>
											</div>
											<div class="checkbox"
												style="margin-left: 1em; margin-top: 0.5em;">
												<label><input class="icheckbox" type="checkbox"
													id="nodeFunctn" />&nbsp;&nbsp;Function</label>
											</div>
											<div class="checkbox"
												style="margin-left: 1em; margin-top: 0.5em;">
												<label><input class="icheckbox" type="checkbox"
													id="nodeBusiness" />&nbsp;&nbsp;Business</label>
											</div>
											<div class="checkbox"
												style="margin-left: 1em; margin-top: 0.5em;">
												<label><input class="icheckbox" type="checkbox"
													id="nodeLocation" />&nbsp;&nbsp;Location</label>
											</div>
											<div class="checkbox"
												style="margin-left: 1em; margin-top: 0.5em;">
												<label><input class="icheckbox" type="checkbox"
													id="nodeCompany" />&nbsp;&nbsp;Company</label>
											</div>
											<!-- 
											<div class="checkbox"
												style="margin-left: 1em; margin-top: 0.5em;">
												<label><input class="icheckbox" type="checkbox"
													id="nodePhone" />&nbsp;&nbsp;Phone</label>
											</div>
											<div class="checkbox"
												style="margin-left: 1em; margin-top: 0.5em;">
												<label><input class="icheckbox" type="checkbox"
													id="nodeEmail" />&nbsp;&nbsp;Email</label>
											</div>
											 -->
											<div class="checkbox"
												style="margin-left: 1em; margin-top: 0.5em;">
												<label><input class="icheckbox" type="checkbox"
													id="nodeAge" />&nbsp;&nbsp;Age</label>
											</div>
											<div class="checkbox"
												style="margin-left: 1em; margin-top: 0.5em;">
												<label><input class="icheckbox" type="checkbox"
													id="nodeDoret" />&nbsp;&nbsp;Date of Retirement</label>
											</div>
										</div>
									</div>
								</div>

								<div id="orgChartMenu_Pan"
									style="background: #00ffffff; position: absolute; z-index: 103; right: 0; transform: translate(-43%, 28%); -webkit-transform: translate(-43%, 28%); display: none;">
									<br>&nbsp;&nbsp;
									<button id="panUpOrgChart" class="btn btn-active btn-sm">
										<i class="fa fa-chevron-up"
											style="font-size: 0.8em; color: #303030;"></i>
									</button>
									<br>
									<div style="float: right;">
										<button id="panLeftOrgChart" class="btn btn-active btn-sm">
											<i class="fa fa-chevron-left"
												style="font-size: 0.8em; color: #303030;"></i>
										</button>
										<button id="panRightOrgChart" class="btn btn-active btn-sm">
											<i class="fa fa-chevron-right"
												style="font-size: 0.8em; color: #303030;"></i>
										</button>
									</div>
									<br>
									<button id="panDownOrgChart" class="btn btn-active btn-sm">
										<i class="fa fa-chevron-down"
											style="font-size: 0.8em; color: #303030;"></i>
									</button>

									<!-- <div id="slider-range" style="margin-top: 4.5em;"></div>  -->

								</div>

								<div id="orgChartMenu_Zoom"
									style="background: #00ffffff; position: absolute; z-index: 103; right: 0; transform: translate(-50%, 475%); -webkit-transform: translate(-50%, 475%); display: none;">

									<button id="zoomOutOrgChart" class="btn btn-active btn-sm">
										<i class="fa fa-search-minus"
											style="font-size: 1.4em; color: #303030;"></i>
									</button>
									<button id="zoomInOrgChart" class="btn btn-active btn-sm">
										<i class="fa fa-search-plus"
											style="font-size: 1.4em; color: #303030;"></i>
									</button>
								</div>

								<div id="orgChartLegend" align="center"
									style="background: #FFFFFF; opacity: 0.6; overflow: hidden; border: 0.15em solid #d3d3d3; -webkit-border-radius: 1.2em; -moz-border-radius: 1.2em; border-radius: 1.2em; position: absolute; right: 0; z-index: 103; transform: translate(-5%, 20%); -webkit-transform: translate(-5%, 20%); display: none;">
									<div id="showLegendDiv"
										style="margin: 0.2em 1em; display: none;">
										<a href="javascript:void(0)" id="showLegend"
											style="color: #2c2c2c; font-size: 0.85em; font-weight: bold; font-family: Tahoma;"><i
											class="fa fa-info" id="legendIcon1"></i>&nbsp;&nbsp;L E G E N
											D&nbsp;&nbsp;&nbsp;<i class="fa fa-angle-right"></i> </a>
									</div>
									<div id="hideLegendDiv"
										style="margin-top: 0.4em; margin-bottom: 0.4em; margin-left: 2em; display: inline-block;">
										<a href="javascript:void(0)" id="hideLegend"
											style="color: #2c2c2c; font-size: 0.85em; font-weight: bold; font-family: Tahoma; position: absolute; left: 1em; bottom: 0.4em;"><i
											class="fa fa-info" id="legendIcon2"></i>&nbsp;&nbsp;L E G E N
											D&nbsp;&nbsp;&nbsp;<i class="fa fa-angle-left"></i> </a>
									</div>
									<div id="legendContent">

										<div id="legendContent1">
											<div
												style="width: 0.8em; height: 0.8em; border: 0.1em solid #2c2c2c; background: #aad7ff; display: inline-block; position: absolute; top: 0.5em;"></div>
											<font
												style="font-size: 0.8em; color: #000000; font-family: Tahoma; margin-left: 0.4em; display: inline-block; position: absolute; top: 0.5em; width: 8em;">Filled
												Position</font>
										</div>

										<div id="legendContent2">
											<div
												style="width: 0.8em; height: 0.8em; border: 0.1em solid #2c2c2c; background: #f7d299; display: inline-block; position: absolute; top: 0.5em;"></div>
											<font
												style="font-size: 0.8em; color: #2c2c2c; font-family: Tahoma; margin-left: 0.5em; display: inline-block; position: absolute; top: 0.5em; width: 8em;">&nbsp;Vacant
												Postion</font>
										</div>

										<div id="legendContent3">
											<div
												style="width: 0.8em; height: 0.8em; border: 0.1em solid #2c2c2c; background: #a6e0a6; display: inline-block; position: absolute; top: 0.5em;"></div>
											<font
												style="font-size: 0.8em; color: #2c2c2c; font-family: Tahoma; margin-left: 0.6em; display: inline-block; position: absolute; top: 0.5em; width: 8em;">Matrix
												Position</font>
										</div>
									</div>
								</div>
								<div id="orgChartSave" align="center"
									style="background: #FFFFFF; opacity: 0.6; overflow: hidden; border: 0.15em solid #d3d3d3; -webkit-border-radius: 1.2em; -moz-border-radius: 1.2em; border-radius: 1.2em; position: absolute; z-index: 103; transform: translate(400%, 20%); -webkit-transform: translate(470%, 20%); display: none;">
									<div id="saveOrgChartDiv" style="margin: 0.2em 1em;">
										<a href="javascript:void(0)" id="saveOrgChart"
											style="color: #2c2c2c; font-size: 0.85em; font-weight: normal; font-family: Tahoma;"><i
											class="fa fa-save"></i></a>
									</div>
								</div>

							</div>
							<div id="orgchartLoading" style="background-color: #FFFFFF;">
								<img src="/JubilantOrgChartProject/images/bg/loader.gif"
									style="width: 100%; heiht: 100%;"></img>
							</div>
							<div id="orgchartRootContainer" style="width: 100%;"
								align="center">
								<!-- <div style="width: 100%; height: 100px;"></div> -->
								<div id="orgchartContainer" style="width: 100%;" align="center">
									<div class="dragscroll" id="orgchart"
										style="width: 100%; height: 630px; z-index: -1; background-color: #FFFFFF; overflow: auto;"></div>
								</div>
							</div>
						</div>
						<div id="listviewpanel">
							<div style="background: #ffffff; overflow: hidden;" align="left">
								<div id="tableFilters"
									style="width: 100%; margin-bottom: 1.2em; margin-top: 0.5em; color: #000; font-size: 0.82em;">
									<div class="checkbox"
										style="margin-left: 0.5em; margin-top: 0.5em; display: inline-block;">
										<label><input class="icheckbox" type="checkbox"
											id="listEno" checked />&nbsp;&nbsp;Employee ID</label>
									</div>
									<div class="checkbox"
										style="margin-left: 0.5em; margin-top: 0.5em; display: inline-block;">
										<label><input class="icheckbox" type="checkbox"
											id="listPno" checked />&nbsp;&nbsp;Position No.</label>
									</div>
									<div class="checkbox"
										style="margin-left: 0.5em; margin-top: 0.5em; display: inline-block;">
										<label><input class="icheckbox" type="checkbox"
											id="listCompany" checked />&nbsp;&nbsp;Company</label>
									</div>
									<div class="checkbox"
										style="margin-left: 0.5em; margin-top: 0.5em; display: inline-block;">
										<label><input class="icheckbox" type="checkbox"
											id="listFunctn" checked />&nbsp;&nbsp;Function</label>
									</div>
									<div class="checkbox"
										style="margin-left: 0.5em; margin-top: 0.5em; display: inline-block;">
										<label><input class="icheckbox" type="checkbox"
											id="listBusiness" checked />&nbsp;&nbsp;Business</label>
									</div>
									<div class="checkbox"
										style="margin-left: 0.5em; margin-top: 0.5em; display: inline-block;">
										<label><input class="icheckbox" type="checkbox"
											id="listDept" checked />&nbsp;&nbsp;Dept</label>
									</div>
									<div class="checkbox"
										style="margin-left: 0.5em; margin-top: 0.5em; display: inline-block;">
										<label><input class="icheckbox" type="checkbox"
											id="listLocation" checked />&nbsp;&nbsp;Location</label>
									</div>
									<div class="checkbox"
										style="margin-left: 0.5em; margin-top: 0.5em; display: inline-block;">
										<label><input class="icheckbox" type="checkbox"
											id="listGrade" checked />&nbsp;&nbsp;Grade</label>
									</div>
									<div class="checkbox"
										style="margin-left: 0.5em; margin-top: 0.5em; display: inline-block;">
										<label><input class="icheckbox" type="checkbox"
											id="listTenure" checked />&nbsp;&nbsp;Tenure</label>
									</div>
									<div class="checkbox"
										style="margin-left: 0.5em; margin-top: 0.5em; display: inline-block;">
										<label><input class="icheckbox" type="checkbox"
											id="listExp" checked />&nbsp;&nbsp;Total Exp</label>
									</div>
									<div class="checkbox"
										style="margin-left: 0.5em; margin-top: 0.5em; display: inline-block;">
										<label><input class="icheckbox" type="checkbox"
											id="listDIcount" checked />&nbsp;&nbsp;Direct/Indirect Count</label>
									</div>
									<div class="checkbox"
										style="margin-left: 0.5em; margin-top: 0.5em; display: inline-block;">
										<label><input class="icheckbox" type="checkbox"
											id="listAge" checked />&nbsp;&nbsp;Age</label>
									</div>
									<div class="checkbox"
										style="margin-left: 0.5em; margin-top: 0.5em; display: inline-block;">
										<label><input class="icheckbox" type="checkbox"
											id="listDateOfRetirement" checked />&nbsp;&nbsp;Date of
											Retirement</label>
									</div>
									<div class="checkbox"
										style="margin-left: 0.5em; margin-top: 0.5em; display: inline-block;">
										<label><input class="icheckbox" type="checkbox"
											id="listPhone" checked />&nbsp;&nbsp;Phone</label>
									</div>
									<div class="checkbox"
										style="margin-left: 0.5em; margin-top: 0.5em; display: inline-block;">
										<label><input class="icheckbox" type="checkbox"
											id="listEmail" checked />&nbsp;&nbsp;Email</label>
									</div>
								</div>

								<div id="saveTableDiv" class="col-lg-12" align="center">
									<div
										style="background: #FFFFFF; overflow: hidden; width: 11.5em; border: 0.15em solid #d3d3d3; -webkit-border-radius: 1.2em; -moz-border-radius: 1.2em; border-radius: 1.2em;">
										<div style="margin: 0.2em 1em; width: 9.3em;">
											<a href="javascript:void(0)" id="saveTable"
												style="color: #2c2c2c; font-size: 0.85em; font-weight: bold;"><i
												class="fa fa-file-excel-o"></i>&nbsp;Save Table as Excel</a>
										</div>
									</div>
									<br>
								</div>

								<div id="tableDiv" style="width: 100%">
									<table id="listViewTable"
										class="collaptable table table-hover table-condensed"
										style="color: #2c2c2c; font-size: 0.81em; font-family: Tahoma;">
										<tbody>
											<tr class="act-tr-level-undefined">
												<th id="thName" style="font-weight: bold;">&nbsp;&nbsp;NAME</th>
												<th id="thEno" style="font-weight: bold;">EMP ID</th>
												<th id="thTitle" style="font-weight: bold;">DESIGNATION</th>
												<th id="thPno" style="font-weight: bold;">POSITION NO.</th>
												<th id="thCompany" style="font-weight: bold;">COMPANY</th>
												<th id="thFunctn" style="font-weight: bold;">FUNCTION</th>
												<th id="thBusiness" style="font-weight: bold;">BUSINESS</th>
												<th id="thDept" style="font-weight: bold;">DEPT</th>
												<th id="thLocation" style="font-weight: bold;">LOCATION</th>
												<th id="thGrade" style="font-weight: bold;">GRADE</th>
												<th id="thTenure" style="font-weight: bold;">TENURE</th>
												<th id="thExp" style="font-weight: bold;">TOTAL EXP</th>
												<th id="thDIcount" style="font-weight: bold;">DIRECT/INDIRECT
													(TOTAL)</th>
												<th id="thAge" style="font-weight: bold;">AGE</th>
												<th id="thDateOfRetirement"
													style="font-weight: bold; display: none;">RETIREMENT
													DATE</th>
												<th id="thPhone" style="font-weight: bold;">PHONE</th>
												<th id="thEmail" style="font-weight: bold;">EMAIL</th>
											</tr>
										</tbody>
										<tbody id="orgTableBody">
											<tr data-id="80000014" data-parent=""
												style="background-color: #bee9ff" data-level="0"
												class="act-tr-expanded act-tr-level-0">
												<td id="trNameFirst" style="width: 45%;"><a
													href="javascript:void(0)" class="act-more act-expanded"><i
														class="fa fa-minus-circle" style="font-size: 1.2em;"#000";=""></i>&nbsp;&nbsp;</a>Amitabh Bhattacharya
										</td>
												<td id="trEno" style="width: 5%;">10012289</td>
												<td id="trTitle" style="width: 15%;">Artificial intelligence</td>
												<td id="trPno" style="width: 5%;">80000014</td>
												<td id="trCompany">CrossTAB</td>
												<td id="trFunctn">PHd</td>
												<td id="trBusiness">Manager</td>
												<td id="trDept">CrosstabIT Noida </td>
												<td id="trLocation">CrosstabIT Noida</td>
												<td id="trGrade">14A</td>
												<td id="trTenure" style="width: 5%;">10 Years</td>
												<td id="trExp" style="width: 5%;">24.48 Years</td>
												<td id="trDIcount" style="text-align: center; width: 5%;">11
													/ 269 (280)</td>
												<td id="trAge" style="width: 5%;">52 Years</td>
												<td id="trDateOfRetirement"
													style="width: 6%; display: none;">12-Nov-2022</td>
												<td id="trPhone">999999999</td>
												<td id="trEmail">amit[AT]crosstab.ac.in</td>
											</tr>
											<tr data-id="80002749" data-parent="80000014"
												style="background-color: #bee9ff" data-level="1"
												class="act-tr-level-1">
												<td id="trName" style="width: 45%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a
													class="fa fa-plus-circle" id="collapseIcon"
													value="80002749"
													style="font-size: 1.2em; padding-right: 6px;"></a>ASHOK
													VARMA
												</td>
												<td id="trEno" style="width: 5%;">10010993</td>
												<td id="trTitle" style="width: 15%;">Assistant Manager</td>
												<td id="trPno" style="width: 5%;">80002749</td>
												<td id="trCompany">CrossTAB</td>
												<td id="trFunctn">PHd</td>
												<td id="trBusiness">Manager</td>
												<td id="trDept">CrosstabIT Noida </td>
												<td id="trLocation">CrosstabIT Noida</td>
												<td id="trGrade">14A</td>
												<td id="trTenure" style="width: 5%;">10 Years</td>
												<td id="trExp" style="width: 5%;">24.48 Years</td>
												<td id="trDIcount" style="text-align: center; width: 5%;">11
													/ 269 (280)</td>
												<td id="trAge" style="width: 5%;">52 Years</td>
												<td id="trDateOfRetirement"
													style="width: 6%; display: none;">12-Nov-2022</td>
												<td id="trPhone">999999999</td>
												<td id="trEmail">amit[AT]crosstab.ac.in</td>
											</tr>
											<tr data-id="80000051" data-parent="80000014"
												style="background-color: #bee9ff" data-level="1"
												class="act-tr-level-1">
												<td id="trName" style="width: 45%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a
													class="fa fa-plus-circle" id="collapseIcon"
													value="80000051"
													style="font-size: 1.2em; padding-right: 6px;"></a>Anil Gaur
												</td>
												<td id="trEno" style="width: 5%;">10009546</td>
												<td id="trTitle" style="width: 15%;">Assistant Manager</td>
												<td id="trPno" style="width: 5%;">80000051</td>
												<td id="trCompany">CrossTAB</td>
												<td id="trFunctn">PHd</td>
												<td id="trBusiness">Manager</td>
												<td id="trDept">CrosstabIT Noida </td>
												<td id="trLocation">CrosstabIT Noida</td>
												<td id="trGrade">14A</td>
												<td id="trTenure" style="width: 5%;">10 Years</td>
												<td id="trExp" style="width: 5%;">24.48 Years</td>
												<td id="trDIcount" style="text-align: center; width: 5%;">11
													/ 269 (280)</td>
												<td id="trAge" style="width: 5%;">52 Years</td>
												<td id="trDateOfRetirement"
													style="width: 6%; display: none;">12-Nov-2022</td>
												<td id="trPhone">999999999</td>
												<td id="trEmail">amit[AT]crosstab.ac.in</td>
											</tr>
											<tr data-id="80006088" data-parent="80000014"
												style="background-color: #bee9ff" data-level="1"
												class="act-tr-level-1">
												<td id="trName" style="width: 45%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a
													class="fa fa-plus-circle" id="collapseIcon"
													value="80006088"
													style="font-size: 1.2em; padding-right: 6px;"></a>Braj
													Mohan Verma
												</td>
												<td id="trEno" style="width: 5%;">10012775</td>
												<td id="trTitle" style="width: 15%;">Assistant Manager</td>
												<td id="trPno" style="width: 5%;">80000051</td>
												<td id="trCompany">CrossTAB</td>
												<td id="trFunctn">PHd</td>
												<td id="trBusiness">Manager</td>
												<td id="trDept">CrosstabIT Noida </td>
										
												<td id="trLocation">CrosstabIT Noida</td>
												<td id="trGrade">14A</td>
												<td id="trTenure" style="width: 5%;">10 Years</td>
												<td id="trExp" style="width: 5%;">24.48 Years</td>
												<td id="trDIcount" style="text-align: center; width: 5%;">11
													/ 269 (280)</td>
												<td id="trAge" style="width: 5%;">52 Years</td>
												<td id="trDateOfRetirement"
													style="width: 6%; display: none;">12-Nov-2022</td>
												<td id="trPhone">999999999</td>
												<td id="trEmail">amit[AT]crosstab.ac.in</td>
											</tr>
											
											<tr data-id="80011782" data-parent="80000014"
												style="background-color: #bee9ff" data-level="1"
												class="act-tr-level-1">
												<td id="trName" style="width: 45%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a
													class="fa fa-plus-circle" id="collapseIcon"
													value="80011782"
													style="font-size: 1.2em; padding-right: 6px;"></a>Manoj
													Singlachar
												</td>
												<td id="trEno" style="width: 5%;">20001672</td>
												<td id="trTitle" style="width: 15%;">Assistant Manager</td>
												<td id="trPno" style="width: 5%;">80011782</td>
												<td id="trCompany">CrossTAB</td>
												<td id="trFunctn">PHd</td>
												<td id="trBusiness">Manager</td>
												<td id="trDept">CrosstabIT Noida </td>
												<td id="trLocation">CrosstabIT Noida</td>
												<td id="trGrade">14A</td>
												<td id="trTenure" style="width: 5%;">10 Years</td>
												<td id="trExp" style="width: 5%;">24.48 Years</td>
												<td id="trDIcount" style="text-align: center; width: 5%;">11
													/ 269 (280)</td>
												<td id="trAge" style="width: 5%;">52 Years</td>
												<td id="trDateOfRetirement"
													style="width: 6%; display: none;">12-Nov-2022</td>
												<td id="trPhone">999999999</td>
												<td id="trEmail">amit[AT]crosstab.ac.in</td>
											</tr>
											<tr data-id="80014446" data-parent="80000014"
												style="background-color: #bee9ff" data-level="1"
												class="act-tr-level-1">
												<td id="trName" style="width: 45%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a
													class="fa fa-plus-circle" id="collapseIcon"
													value="80014446"
													style="font-size: 1.2em; padding-right: 6px;"></a>Mukesh
													Singh Bhadauria
												</td>
												<td id="trEno" style="width: 5%;">10003880</td>
												<td id="trTitle" style="width: 15%;">Assistant Manager</td>
												<td id="trPno" style="width: 5%;">80014446</td>
												<td id="trCompany">CrossTAB</td>
												<td id="trFunctn">PHd</td>
												<td id="trBusiness">Manager</td>
												<td id="trDept">CrosstabIT Noida </td>
												<td id="trLocation">CrosstabIT Noida</td>
												<td id="trGrade">14A</td>
												<td id="trTenure" style="width: 5%;">10 Years</td>
												<td id="trExp" style="width: 5%;">24.48 Years</td>
												<td id="trDIcount" style="text-align: center; width: 5%;">11
													/ 269 (280)</td>
												<td id="trAge" style="width: 5%;">52 Years</td>
												<td id="trDateOfRetirement"
													style="width: 6%; display: none;">12-Nov-2022</td>
												<td id="trPhone">999999999</td>
												<td id="trEmail">amit[AT]crosstab.ac.in</td>
											</tr>
											<tr data-id="80000143" data-parent="80000014"
												style="background-color: #bee9ff" data-level="1"
												class="act-tr-level-1">
												<td id="trName" style="width: 45%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a
													class="fa fa-plus-circle" id="collapseIcon"
													value="80000143"
													style="font-size: 1.2em; padding-right: 6px;"></a>Nikhil
													Gupta
												</td>
												<td id="trEno" style="width: 5%;">10010434</td>
												<td id="trTitle" style="width: 15%;">Assistant Manager</td>
												<td id="trPno" style="width: 5%;">80000143</td>
												<td id="trCompany">CrossTAB</td>
												<td id="trFunctn">PHd</td>
												<td id="trBusiness">Manager</td>
												<td id="trDept">CrosstabIT Noida </td>
												<td id="trLocation">CrosstabIT Noida</td>
												<td id="trGrade">14A</td>
												<td id="trTenure" style="width: 5%;">10 Years</td>
												<td id="trExp" style="width: 5%;">24.48 Years</td>
												<td id="trDIcount" style="text-align: center; width: 5%;">11
													/ 269 (280)</td>
												<td id="trAge" style="width: 5%;">52 Years</td>
												<td id="trDateOfRetirement"
													style="width: 6%; display: none;">12-Nov-2022</td>
												<td id="trPhone">999999999</td>
												<td id="trEmail">amit[AT]crosstab.ac.in</td>
											</tr>
											<tr data-id="80009633" data-parent="80000014"
												style="background-color: #bee9ff" data-level="1"
												class="act-tr-level-1">
												<td id="trName" style="width: 45%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a
													class="fa fa-plus-circle" id="collapseIcon"
													value="80009633"
													style="font-size: 1.2em; padding-right: 6px;"></a>Anil Seth
												</td>
												<td id="trEno" style="width: 5%;">50012236</td>
												<td id="trTitle" style="width: 15%;">Assistant Manager</td>
												<td id="trPno" style="width: 5%;">80009633</td>
												<td id="trCompany">CrossTAB</td>
												<td id="trFunctn">PHd</td>
												<td id="trBusiness">Manager</td>
												<td id="trDept">CrosstabIT Noida </td>
												<td id="trLocation">CrosstabIT Noida</td>
												<td id="trGrade">14A</td>
												<td id="trTenure" style="width: 5%;">10 Years</td>
												<td id="trExp" style="width: 5%;">24.48 Years</td>
												<td id="trDIcount" style="text-align: center; width: 5%;">11
													/ 269 (280)</td>
												<td id="trAge" style="width: 5%;">52 Years</td>
												<td id="trDateOfRetirement"
													style="width: 6%; display: none;">12-Nov-2022</td>
												<td id="trPhone">999999999</td>
												<td id="trEmail">amit[AT]crosstab.ac.in</td>
											</tr>
											<tr data-id="80009127" data-parent="80000014"
												style="background-color: #bee9ff" data-level="1"
												class="act-tr-level-1">
												<td id="trName" style="width: 45%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a
													class="fa fa-plus-circle" id="collapseIcon"
													value="80009127"
													style="font-size: 1.2em; padding-right: 6px;"></a>Ajay Jain
												</td>
												<td id="trEno" style="width: 5%;">10007093</td>
												<td id="trTitle" style="width: 15%;">Assistant Manager</td>
												<td id="trPno" style="width: 5%;">80009127</td>
												<td id="trCompany">CrossTAB</td>
												<td id="trFunctn">PHd</td>
												<td id="trBusiness">Manager</td>
												<td id="trDept">CrosstabIT Noida </td>
												<td id="trLocation">CrosstabIT Noida</td>
												<td id="trGrade">14A</td>
												<td id="trTenure" style="width: 5%;">10 Years</td>
												<td id="trExp" style="width: 5%;">24.48 Years</td>
												<td id="trDIcount" style="text-align: center; width: 5%;">11
													/ 269 (280)</td>
												<td id="trAge" style="width: 5%;">52 Years</td>
												<td id="trDateOfRetirement"
													style="width: 6%; display: none;">12-Nov-2022</td>
												<td id="trPhone">999999999</td>
												<td id="trEmail">amit[AT]crosstab.ac.in</td>
											</tr>
											<tr data-id="80009128" data-parent="80000014"
												style="background-color: #bee9ff" data-level="1"
												class="act-tr-level-1">
												<td id="trName" style="width: 45%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a
													class="fa fa-plus-circle" id="collapseIcon"
													value="80009128"
													style="font-size: 1.2em; padding-right: 6px;"></a>Arnab 
													Bajpai
												</td>
												<td id="trEno" style="width: 5%;">10012280</td>
												<td id="trTitle" style="width: 15%;">Manager</td>
												<td id="trPno" style="width: 5%;">80009128</td>
												<td id="trCompany">CrossTAB</td>
												<td id="trFunctn">PHd</td>
												<td id="trBusiness">Manager</td>
												<td id="trDept">CrosstabIT Noida </td>
												<td id="trLocation">CrosstabIT Noida</td>
												<td id="trGrade">14A</td>
												<td id="trTenure" style="width: 5%;">10 Years</td>
												<td id="trExp" style="width: 5%;">24.48 Years</td>
												<td id="trDIcount" style="text-align: center; width: 5%;">11
													/ 269 (280)</td>
												<td id="trAge" style="width: 5%;">52 Years</td>
												<td id="trDateOfRetirement"
													style="width: 6%; display: none;">12-Nov-2022</td>
												<td id="trPhone">999999999</td>
												<td id="trEmail">arnab[AT]crosstab.ac.in</td>
											</tr>
										</tbody>
									</table>
								</div>
								<div id="tableLoadingDiv"
									style="width: 100%; background: #FFFFFF;">
									<img src="/JubilantOrgChartProject/images/bg/loader.gif"
										style="width: 100%; height: 100%;"></img>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="panel mal" id="orgChartSketchDiv" style="display: none;">
				<div class="page-title-breadcrumb option-demo mbxxl">
					<div class="page-header pull-left">
						<i class="fa fa-edit fa-5x"></i>
						<div class="page-title">&nbsp;&nbsp;Save Chart as Image/PDF</div>
					</div>
					<div class="clearfix"></div>
				</div>
				<div class="panel-body" id="orgChartSketchDivBody"></div>
			</div>
		</div>
		<div id="divLoading"></div>
	</div>
	<!--END CONTENT-->
	<!--BEGIN FOOTER-->
	<!--
	<div id="footer">
	</div>
	-->
	<!--END FOOTER-->
	<!--END PAGE WRAPPER-->

	<script src="script/jquery.js"></script>
	<script src="script/jquery-migrate-1.2.1.min.js"></script>
	<script src="script/jquery-ui.js"></script>
	<script src="script/bootstrap.min.js"></script>
	<script src="script/bootstrap-hover-dropdown.js"></script>
	<script src="script/html5shiv.js"></script>
	<script src="script/icheck.min.js"></script>
	<script src="script/pace.min.js"></script>

	<script src="script/raphael.js"></script>

	<!-- 
	<script src="script/raphael.export.js"></script>
	 -->
	<script src="script/Treant.js"></script>

	<script src="script/jquery.easing.js"></script>
	<!-- 
	<script src="script/jquery.transition.js"></script>
 	-->
	<script src="script/jquery.scrollTo.min.js"></script>

	<script src="script/perfect-scrollbar.js"></script>

	<script src="script/jquery.aCollapTable.js"></script>

	<script src="script/jquery.jscrollpane.min.js"></script>

	<script src="script/jquery.easytabs.js"></script>

	<script src="script/jquery.tiny-draggable.min.js"></script>


	<script src="script/jquery.mousewheel.js"></script>
	<script src="script/jquery.kinetic.js"></script>
	<script src="script/jquery.zoomooz.js"></script>

	<script src="script/dragscroll.js"></script>

	<script src="script/tooltipster.bundle.min.js"></script>

	<script src="script/FileSaver.js"></script>
	<script src="script/tableexport.min.js"></script>

	<script src="script/download.js"></script>

	<script src="script/jquery.autocomplete.js"></script>

	<script src="script/jspdf.debug.js"></script>
	<script src="script/addimage.js"></script>

	<script src="script/html2pdf.js"></script>

	<script src="script/jszip.min.js"></script>
	<script src="script/pptxgen.js"></script>

	<script src="script/lz-string.js"></script>

	<script type="text/javascript" src="script/rgbcolor.js"></script>
	<script type="text/javascript" src="script/StackBlur.js"></script>
	<script type="text/javascript" src="script/canvg.js"></script>

	<script src="script/html2canvas.min.js"></script>
	<script src="script/html2canvas.svg.min.js"></script>

	<script>
		if ( $.browser.chrome ) {
			document.write( '<'+'link rel="stylesheet" href="styles/printable.orgchart.css" />' );
			$( "#orgChartLegend" ).show();
			$( "#orgChartMenu_Pan" ).show();
			$( "#orgChartMenu_Zoom" ).show();
		} else if ( $.browser.mozilla ) {
			document.write( '<'+'link rel="stylesheet" href="styles/printable.orgchart2.css" />' );
			$( "#orgChartLegend" ).show();
			$( "#orgChartMenu_Pan" ).show();
			$( "#orgChartMenu_Zoom" ).show();
		} else if ( $.browser.msie ) {
			document.write( '<'+'link rel="stylesheet" href="styles/printable.orgchart2.css" />' );
			$( "#orgChartLegend" ).show();
			$( "#orgChartMenu_Pan" ).show();
			$( "#orgChartMenu_Zoom" ).show();
		} else if ( $.browser.safari ) {
			document.write( '<'+'link rel="stylesheet" href="styles/printable.orgchart3.css" />' );
			$( "#orgChartLegend" ).show();
			$( "#orgChartMenu_Pan" ).show();
			$( "#orgChartMenu_Zoom" ).show();
		}
	</script>

	<script>
		var function_id;

		var firstUserName;

		var orgchartScrollTop, orgchartScrollLeft;

		var jsonData, hideRootNodeFlag, tableData;
		var DPicHiddenFlag = 0;
		var NameHiddenFlag = 0;

		var zoomLevel;
		var activeID = "", activeTableID = "";
		var LegendSwitchedflag = 0;
		var tableInitializedFlag = 0;

		var currentTableRequest = null;

		var currentNodeCount = 0;

		var activeFields = 0;

		var dropLevel = [
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
		];
		/*
				var dropLevel2 = [
						0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
				];
		 */
		var userName = "", userTitle = "", curDate = "", logoBase64 = "", fileFormat = "";

		var mainnodeObjChildrenCount;

		var dmObj, mainnodeObj;
		var secArr = [], mmArr = [];

		$( document )
				.ready(
						function () {

							$( document ).keydown( function ( event ) {
								if ( event.ctrlKey == true && ( event.which == '61' || event.which == '107' || event.which == '173' || event.which == '109' || event.which == '187' || event.which == '189' ) ) {
									//alert('disabling zooming');
									event.preventDefault();
									// 107 Num Key  +
									//109 Num Key  -
									//173 Min Key  hyphen/underscor Hey
									// 61 Plus key  +/=
								}
							} );

							$( window ).bind( 'mousewheel DOMMouseScroll', function ( event ) {
								if ( event.ctrlKey == true ) {
									//alert('disabling zooming');
									event.preventDefault();
								}
							} );

							$( '#tabView' ).easytabs( {
								updateHash : false
							} );

							$( "#showLegend" ).click( function () {

								$( "#orgChartLegend" ).css( "-webkit-border-radius", "1.2em" );
								$( "#orgChartLegend" ).css( "-moz-border-radius", "1.2em" );
								$( "#orgChartLegend" ).css( "border-radius", "1.2em" );
								$( "#orgChartLegend" ).css( "transform", "translate(-5%, 20%)" );
								$( "#orgChartLegend" ).css( "-webkit-transform", "translate(-5%, 20%)" );

								$( "#legendContent" ).fadeIn();
								$( "#showLegendDiv" ).hide();
								$( "#hideLegendDiv" ).css( "display", "inline-block" );

								/*
								setTimeout( function () {
									$( "#hideLegend" ).trigger( 'click' );
								}, 10000 );
								 */
							} );

							$( "#hideLegend" ).click( function () {

								$( "#orgChartLegend" ).css( "-webkit-border-radius", " 3em" );
								$( "#orgChartLegend" ).css( "-moz-border-radius", " 3em" );
								$( "#orgChartLegend" ).css( "border-radius", " 3em" );
								$( "#orgChartLegend" ).css( "transform", "translate(-242%, 20%)" );
								$( "#orgChartLegend" ).css( "-webkit-transform", "translate(-242%, 20%)" );

								$( "#legendContent" ).hide();
								$( "#hideLegendDiv" ).hide();
								$( "#showLegendDiv" ).css( "display", "inline-block" );
							} );

							$( document ).on( 'mouseenter', "#orgChartFilters, #orgChartLegend, #orgChartSave", function () {
								$( this ).css( 'opacity', '1' );
							} ).on( 'mouseleave', "#orgChartFilters, #orgChartLegend, #orgChartSave", function () {
								$( this ).css( 'opacity', '0.6' );
							} );

							$( document ).on( 'mouseenter', "#panUpOrgChart, #panDownOrgChart, #panLeftOrgChart, #panRightOrgChart, #zoomInOrgChart, #zoomOutOrgChart", function () {
								$( this ).css( 'opacity', '1' );
							} ).on( 'mouseleave', "#panUpOrgChart, #panDownOrgChart, #panLeftOrgChart, #panRightOrgChart, #zoomInOrgChart, #zoomOutOrgChart", function () {
								$( this ).css( 'opacity', '0.7' );
							} );

							/*
							 var valMap = [1, 2, 3, 4];
							    $("#slider-range").slider({
							        min: 1,
							        max: 4,
							        value: 2,
							        slide: function(event, ui) {                        
							            //$("#amount").val(valMap[ui.value]);                
							        }       
							    });
							 */

							var position_no = $( "#pID" ).val();
							function_id = $( "#fID" ).val();

							$( "#searchIcon" ).show();
							$( "#searchBox" ).show();
							$( "#orgChartSave" ).show();

							data = [
									{
										"HTMLclass" : "nodeCollapsible",
										"pseudo" : "true",
										"children" : [
												{
													"HTMLclass" : "nodeCollapsible",
													"pseudo" : "true",
													"connectors" : {
														"type" : "step",
														"style" : {
															"stroke" : "#00FFFFFF",
															"stroke-dasharray" : " ",
															"stroke-width" : "0"
														}
													},
													"children" : [
														{
															"HTMLclass" : "nodeCollapsible",
															"pseudo" : "true",
															"connectors" : {
																"type" : "step",
																"style" : {
																	"stroke" : "#00FFFFFF",
																	"stroke-dasharray" : " ",
																	"stroke-width" : "0"
																}
															},
															"children" : [
																{
																	"text" : {
																		"name" : "Anil Seth.",
																		"title" : "Assistant Manager",
																		"dept" : "CrosstabIT Noida",
																		"grade" : "10",
																		"functn" : "Human Resources",
																		"business" : "Education",
																		"location" : "CrossTAB",
																		"company" : "CrossTAB",
																		"age" : "44 Years",
																		"doret" : "31-Dec-2030"
																	},
																	"HTMLclass" : "nodeSec1WithLink",
																	"image" : "user.png",
																	"HTMLid" : "sec1",
																	"HTMLid2" : "80001015",
																	"level" : "0"
																}
															]
														}
													]
												},
												{
													"text" : {
														"name" : "Mr. H S Bhartia",
														"title" : "Assistant Manager",
														"dept" : "CrosstabIT Noida",
														"grade" : "10",
														"functn" : "Human Resources",
														"business" : "Education",
														"location" : "CrossTAB",
														"company" : "CrossTAB",
														"age" : "44 Years",
														"doret" : "31-Dec-2030"
													},
													"HTMLclass" : "nodeCollapsible",
													"image" : "user.png",
													"HTMLid" : "dm",
													"HTMLid2" : "80000001",
													"level" : "0",
													"children" : [
														{
															"text" : {
																"name" : "Raju Sunil Mistry",
																"title" : "Assistant Manager",
																"dept" : "CrosstabIT Noida",
																"grade" : "10",
																"functn" : "Human Resources",
																"business" : "Education",
																"location" : "CrossTAB",
																"company" : "CrossTAB",
																"age" : "44 Years",
																"doret" : "31-Dec-2030"
															},
															"HTMLclass" : "nodeCollapsible",
															"image" : "user.png",
															"collapsable" : false,
															"collapsed" : false,
															"HTMLid" : "main_node",
															"HTMLid2" : "80000014",
															"level" : "1",
															"children" : [
																	{
																		"text" : {
																			"name" : "ASHOK VARMA",
																			"title" : "Assistant Manager",
																			"dept" : "CrosstabIT Noida",
																			"grade" : "10",
																			"functn" : "Human Resources",
																			"business" : "Education",
																			"location" : "CrossTAB",
																			"company" : "CrossTAB",
																			"age" : "44 Years",
																			"doret" : "31-Dec-2030"
																		},
																		"HTMLclass" : "nodeCollapsible",
																		"HTMLid" : "80002749",
																		"image" : "user.png",
																		"level" : "2",
																		"collapsable" : false,
																		"collapsed" : false
																	},
																	{
																		"text" : {
																			"name" : "Anil Gaur",
																			"title" : "Assistant Manager",
																			"dept" : "CrosstabIT Noida",
																			"grade" : "10",
																			"functn" : "Human Resources",
																			"business" : "Education",
																			"location" : "CrossTAB",
																			"company" : "CrossTAB",
																			"age" : "44 Years",
																			"doret" : "31-Dec-2030"
																		},
																		"HTMLclass" : "nodeCollapsible",
																		"HTMLid" : "80000051",
																		"image" : "user.png",
																		"level" : "2",
																		"collapsable" : false,
																		"collapsed" : false
																	},
																	{
																		"text" : {
																			"name" : "Braj Mohan Verma",
																			"title" : "Assistant Manager",
																			"dept" : "CrosstabIT Noida",
																			"grade" : "10",
																			"functn" : "Human Resources",
																			"business" : "Education",
																			"location" : "CrossTAB",
																			"company" : "CrossTAB",
																			"age" : "44 Years",
																			"doret" : "31-Dec-2030"
																		},
																		"HTMLclass" : "nodeCollapsible",
																		"HTMLid" : "80006088",
																		"image" : "user.png",
																		"level" : "2",
																		"collapsable" : false,
																		"collapsed" : false
																	},
																	{
																		"text" : {
																			"name" : "Hreetesh Bhandari",
																			"title" : "Assistant Manager",
																			"dept" : "CrosstabIT Noida",
																			"grade" : "10",
																			"functn" : "Human Resources",
																			"business" : "Education",
																			"location" : "CrossTAB",
																			"company" : "CrossTAB",
																			"age" : "44 Years",
																			"doret" : "31-Dec-2030"
																		},
																		"HTMLclass" : "nodeCollapsible",
																		"HTMLid" : "80000332",
																		"image" : "user.png",
																		"level" : "2"
																		
																	},
																	{
																		"text" : {
																			"name" : "Manoj sharma",
																			"title" : "Assistant Manager",
																			"dept" : "CrosstabIT Noida",
																			"grade" : "10",
																			"functn" : "Human Resources",
																			"business" : "Education",
																			"location" : "CrossTAB",
																			"company" : "CrossTAB",
																			"age" : "44 Years",
																			"doret" : "31-Dec-2030"
																		},
																		"HTMLclass" : "nodeCollapsible",
																		"HTMLid" : "80011782",
																		"image" : "user.png",
																		"level" : "2",
																		"collapsable" : false,
																		"collapsed" : false
																	},
																	{
																		"text" : {
																			"name" : "Mukesh Singh Bhadauria",
																			"title" : "Assistant Manager",
																			"dept" : "CrosstabIT Noida",
																			"grade" : "10",
																			"functn" : "Human Resources",
																			"business" : "Education",
																			"location" : "CrossTAB",
																			"company" : "CrossTAB",
																			"age" : "44 Years",
																			"doret" : "31-Dec-2030"
																		},
																		"HTMLclass" : "nodeCollapsible",
																		"HTMLid" : "80014446",
																		"image" : "user.png",
																		"level" : "2",
																		"collapsable" : false,
																		"collapsed" : false
																	},
																	{
																		"text" : {
																			"name" : "Nikhil Gupta",
																			"title" : "Assistant Manager",
																			"dept" : "CrosstabIT Noida",
																			"grade" : "10",
																			"functn" : "Human Resources",
																			"business" : "Education",
																			"location" : "CrossTAB",
																			"company" : "CrossTAB",
																			"age" : "44 Years",
																			"doret" : "31-Dec-2030"
																		},
																		"HTMLclass" : "nodeCollapsible",
																		"HTMLid" : "80000143",
																		"image" : "user.png",
																		"level" : "2",
																		"collapsable" : false,
																		"collapsed" : false
																	},
																	{
																		"text" : {
																			"name" : "PIERRE-MARCEL COTE",
																			"title" : "Assistant Manager",
																			"dept" : "CrosstabIT Noida",
																			"grade" : "10",
																			"functn" : "Human Resources",
																			"business" : "Education",
																			"location" : "CrossTAB",
																			"company" : "CrossTAB",
																			"age" : "44 Years",
																			"doret" : "31-Dec-2030"
																		},
																		"HTMLclass" : "nodeCollapsible",
																		"HTMLid" : "80009633",
																		"image" : "user.png",
																		"level" : "2",
																		"collapsable" : false,
																		"collapsed" : false
																	},
																	{
																		"text" : {
																			"name" : "Shivshant Kumar",
																			"title" : "Assistant Manager",
																			"dept" : "CrosstabIT Noida",
																			"grade" : "10",
																			"functn" : "Human Resources",
																			"business" : "Education",
																			"location" : "CrossTAB",
																			"company" : "CrossTAB",
																			"age" : "44 Years",
																			"doret" : "31-Dec-2030"
																		},
																		"HTMLclass" : "nodeCollapsible",
																		"HTMLid" : "80009127",
																		"image" : "user.png",
																		"level" : "2",
																		"collapsable" : false,
																		"collapsed" : false
																	},
																	{
																		"text" : {
																			"name" : "Vinita Koul",
																			"title" : "Assistant Manager",
																			"dept" : "CrosstabIT Noida",
																			"grade" : "10",
																			"functn" : "Human Resources",
																			"business" : "Education",
																			"location" : "CrossTAB",
																			"company" : "CrossTAB",
																			"age" : "44 Years",
																			"doret" : "31-Dec-2030"
																		},
																		"HTMLclass" : "nodeCollapsible",
																		"HTMLid" : "80009128",
																		"image" : "user.png",
																		"level" : "2",
																		"collapsable" : false,
																		"collapsed" : false
																	}
															],
															"childrenDropLevel" : "2"
														}
													]
												}
										]
									}, "true"
							];

							jsonData = data[ 0 ];

							getUserName( jsonData );
							firstUserName = userName;
							userName = "";

							hideRootNodeFlag = JSON.parse( data[ 1 ] );

							var jsonDataString = JSON.stringify( jsonData );
							jsonDataString = jsonDataString.replace( /"dept"/g, '"dept_inactive"' );
							jsonDataString = jsonDataString.replace( /"grade"/g, '"grade_inactive"' );
							jsonDataString = jsonDataString.replace( /"functn"/g, '"functn_inactive"' );
							jsonDataString = jsonDataString.replace( /"business"/g, '"business_inactive"' );
							jsonDataString = jsonDataString.replace( /"location"/g, '"location_inactive"' );
							jsonDataString = jsonDataString.replace( /"company"/g, '"company_inactive"' );
							/*
							jsonDataString = jsonDataString.replace( /"phone"/g, '"phone_inactive"' );
							jsonDataString = jsonDataString.replace( /"email"/g, '"email_inactive"' );
							 */
							jsonDataString = jsonDataString.replace( /"age"/g, '"age_inactive"' );
							jsonDataString = jsonDataString.replace( /"doret"/g, '"doret_inactive"' );
							jsonData = JSON.parse( jsonDataString );
							createOrgChart( hideRootNodeFlag, 0 );

							$( '.icheckbox' ).iCheck( {
								checkboxClass : 'icheckbox_minimal-grey',
								radioClass : 'iradio_minimal-grey',
							} );

							/*
							setTimeout( function () {
								$( "#hideLegend" ).trigger( 'click' );
							}, 4000 );
							 */

							$( '#orgchartRootContainer' ).kinetic().on( 'mousewheel', function ( event, delta, deltaX, deltaY ) {
								//console.log( delta, deltaX, deltaY );
								event.preventDefault();
								zoomLevel = deltaY < 0 ? zoomLevel / 1.2 : zoomLevel * 1.2;
								if ( ( zoomLevel <= 1.6 ) && ( zoomLevel >= 1 ) ) {
									//console.log( z );
									$( '#orgchart' ).zoomTo( {
										targetsize : zoomLevel,
										scalemode : "both",
										easing : "ease",
										duration : 400,
										//nativeanimation: true,
										//preservescroll: false,
										root : $( '#orgchartContainer' )
									} )
								} else if ( zoomLevel > 1.6 ) {
									zoomLevel = 1.6;
									$( '#orgchart' ).zoomTo( {
										targetsize : zoomLevel,
										scalemode : "both",
										easing : "ease",
										duration : 400,
										//nativeanimation: true,
										//preservescroll: false,
										root : $( '#orgchartContainer' )
									} )
								} else if ( zoomLevel < 1 ) {
									zoomLevel = 1;
									$( '#orgchart' ).zoomTo( {
										targetsize : zoomLevel,
										scalemode : "both",
										easing : "ease",
										duration : 400,
										//nativeanimation: true,
										//preservescroll: false,
										root : $( '#orgchartContainer' )
									} )
								}

							} );

							$( "#zoomInOrgChart" ).click( function () {
								zoomLevel = zoomLevel + 0.2;
								if ( ( zoomLevel <= 1.6 ) && ( zoomLevel >= 1 ) ) {

									$( '#orgchart' ).zoomTo( {
										targetsize : zoomLevel,
										scalemode : "both",
										easing : "ease",
										duration : 400,
										//nativeanimation: true,
										//preservescroll: false,
										root : $( '#orgchartContainer' )
									} )
								} else if ( zoomLevel > 1.6 ) {
									zoomLevel = 1.6;
									$( '#orgchart' ).zoomTo( {
										targetsize : zoomLevel,
										scalemode : "both",
										easing : "ease",
										duration : 400,
										//nativeanimation: true,
										//preservescroll: false,
										root : $( '#orgchartContainer' )
									} )
								}

							} );

							$( "#zoomOutOrgChart" ).click( function () {
								zoomLevel = zoomLevel - 0.2;
								if ( zoomLevel >= 1 && zoomLevel <= 1.6 ) {

									$( '#orgchart' ).zoomTo( {
										targetsize : zoomLevel,
										scalemode : "both",
										easing : "ease",
										duration : 400,
										//nativeanimation: true,
										//preservescroll: false,
										root : $( '#orgchartContainer' )
									} )
								} else if ( zoomLevel < 1 ) {
									zoomLevel = 1;
									$( '#orgchart' ).zoomTo( {
										targetsize : zoomLevel,
										scalemode : "both",
										easing : "ease",
										duration : 400,
										//nativeanimation: true,
										//preservescroll: false,
										root : $( '#orgchartContainer' )
									} )
								}
							} );

							$( "#panUpOrgChart" ).click( function () {

								$( '#orgchart' ).animate( {
									scrollTop : '-=100'
								}, 100, 'easeOutQuad' );

								$( '#orgchartContainer' ).animate( {
									scrollTop : '-=100'
								}, 100, 'easeOutQuad' );

								$( '#orgchartRootContainer' ).animate( {
									scrollTop : '-=100'
								}, 100, 'easeOutQuad' );

							} );

							$( "#panDownOrgChart" ).click( function () {

								$( '#orgchart' ).animate( {
									scrollTop : '+=100'
								}, 100, 'easeOutQuad' );

								$( '#orgchartContainer' ).animate( {
									scrollTop : '+=100'
								}, 100, 'easeOutQuad' );

								$( '#orgchartRootContainer' ).animate( {
									scrollTop : '+=100'
								}, 100, 'easeOutQuad' );

							} );

							$( "#panLeftOrgChart" ).click( function () {

								$( '#orgchart' ).animate( {
									scrollLeft : '-=150'
								}, 100, 'easeOutQuad' );

								$( '#orgchartContainer' ).animate( {
									scrollLeft : '-=150'
								}, 100, 'easeOutQuad' );

								$( '#orgchartRootContainer' ).animate( {
									scrollLeft : '-=150'
								}, 100, 'easeOutQuad' );

							} );

							$( "#panRightOrgChart" ).click( function () {

								$( '#orgchart' ).animate( {
									scrollLeft : '+=150'
								}, 100, 'easeOutQuad' );

								$( '#orgchartContainer' ).animate( {
									scrollLeft : '+=150'
								}, 100, 'easeOutQuad' );

								$( '#orgchartRootContainer' ).animate( {
									scrollLeft : '+=150'
								}, 100, 'easeOutQuad' );

							} );

							zoomLevel = 1.4;

							$( '#orgchart' ).zoomTo( {
								targetsize : zoomLevel,
								scalemode : "both",
								easing : "ease",
								duration : 1000,
								//nativeanimation: true,
								preservescroll : true,
								root : $( '#orgchartContainer' )
							} )
							//
							$( "#hideFilters" ).click( function () {

								$( "#filtersContent" ).hide();
								$( "#hideFiltersDiv" ).hide();
								$( "#showFiltersDiv" ).show();
								$( "#orgChartFilters" ).css( "transform", "translate(0%, 20%)" );
								$( "#orgChartFilters" ).css( "-webkit-transform", "translate(0%, 20%)" );

							} );

							$( "#showFilters" ).click( function () {

								$( "#showFiltersDiv" ).hide();
								$( "#hideFiltersDiv" ).show();
								$( "#filtersContent" ).show();
								$( "#orgChartFilters" ).css( "transform", "translate(0%, 2%)" );
								$( "#orgChartFilters" ).css( "-webkit-transform", "translate(0%, 2%)" );

							} );

							$( "#saveTable" ).click( function ( e ) {

								//$( "#listViewTable" ).tableExport();

								e.preventDefault();

								//getting data from our table
								var table_div = document.getElementById( 'listViewTable' );
								var table_html = table_div.outerHTML.replace( /href/g, 'noref' );
								var tab_text = '<html xmlns:x="urn:schemas-microsoft-com:office:excel">';
								tab_text = tab_text + '<head><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet>';
								tab_text = tab_text + '<x:Name>Test Sheet</x:Name>';
								tab_text = tab_text + '<x:WorksheetOptions><x:Panes></x:Panes></x:WorksheetOptions></x:ExcelWorksheet>';
								tab_text = tab_text + '</x:ExcelWorksheets></x:ExcelWorkbook></xml></head><body>';
								tab_text = tab_text + table_html;
								tab_text = tab_text + '</body></html>';

								getUserName( jsonData );
								userTitle = $( '[id^=main_node]  .node-title' ).html();
								curDate = $.datepicker.formatDate( 'd M yy', new Date() );
								var filename = "ListView_" + "Crosstab" + "_" + curDate.replace( / /g, "" ) + ".xls";

								var blob = new Blob( [
									tab_text
								], {
									type : "application/vnd.ms-excel;charset=utf-8"
								} );

								if ( typeof window.navigator.msSaveBlob !== 'undefined' ) {
									// IE workaround for "HTML7007: One or more blob URLs were revoked by closing the blob for which they were created. These URLs will no longer resolve as the data backing the URL has been freed."
									window.navigator.msSaveBlob( blob, filename );
								} else {
									var URL = window.URL || window.webkitURL;
									var downloadUrl = URL.createObjectURL( blob );

									if ( filename ) {
										// use HTML5 a[download] attribute to specify filename
										var a = document.createElement( "a" );
										// safari doesn't support this yet
										if ( typeof a.download === 'undefined' ) {
											window.location = downloadUrl;
										} else {
											a.href = downloadUrl;
											a.download = filename;
											document.body.appendChild( a );
											a.click();
										}
									} else {
										window.location = downloadUrl;
									}

									setTimeout( function () {
										URL.revokeObjectURL( downloadUrl );
									}, 100 ); // cleanup

								}

							} );

							$( "#saveOrgChart" ).click( function () {

								//if ( DPicHiddenFlag === 0 && activeFields > 3 ) {
								if ( activeFields > 3 ) {

									alert( 'You can only select 3 fields (excluding Name) while printing org-charts.' )

								} else {

									$( "#downloadModal" ).modal( 'show' );
									//$( "#downloadImage" ).click();
									//$( "#downloadPDF" ).click();
								}

							} );

							$( "#downloadImage" ).click( function () {

								$( "#exportButtonsDiv" ).hide();
								$( "#exportLoadingDiv" ).show();
								$( "#exportLoadingMessage" ).html( "Optimizing Chart for Download.." );

								$( '#orgchart' ).zoomTo( {
									targetsize : 1,
									scalemode : "both",
									easing : "ease",
									duration : 400,
									//nativeanimation: true,
									//preservescroll: false,
									root : $( '#orgchartContainer' )
								} )

								currentNodeCount = 0;

								var temp_data = JSON.parse( JSON.stringify( jsonData ) );

								deleteCollapsedNodes( temp_data );
								getNodeCount( temp_data );

								if ( currentNodeCount <= 13 ) {

									if ( DPicHiddenFlag === 1 ) {
										createPrintableOrgChart( hideRootNodeFlag, 0, 'nodePrintableLarge', 'JPEG' );
									} else {
										createPrintableOrgChart( hideRootNodeFlag, 0, 'nodeWithPicPrintableLarge', 'JPEG' );

									}

								} else {

									if ( DPicHiddenFlag === 1 ) {
										createPrintableOrgChart( hideRootNodeFlag, 0, 'nodePrintable', 'JPEG' );
									} else {
										createPrintableOrgChart( hideRootNodeFlag, 0, 'nodeWithPicPrintable', 'JPEG' );
									}

								}

							} );

							$( "#downloadPPT" ).click( function () {

								fileFormat = ".pptx";

								$( "#exportButtonsDiv" ).hide();
								$( "#exportLoadingDiv" ).show();
								$( "#exportLoadingMessage" ).html( "<p>Optimizing Chart for Powerpoint..</p><p>(<b>NOTE:&nbsp;</b>This could take a minute or so for large charts, as the chart is recreated in the PPTX file.)</p>" );

								getEditablePPT();

							} );

							$( "#downloadPDF2" ).click( function () {

								fileFormat = ".pdf";

								$( "#exportButtonsDiv" ).hide();
								$( "#exportLoadingDiv" ).show();
								$( "#exportLoadingMessage" ).html( "<p>Optimizing Chart for PDF..</p><p>(<b>NOTE:&nbsp;</b>This could take a minute or so for large charts, as the chart is recreated from the scratch.)</p>" );

								getEditablePPT();

							} );

							$( '.icheckbox' ).on( 'ifChecked', function ( event ) {
								switch ( this.id ) {
									case 'nodeName':
										orgchartScrollTop = $( '#orgchart' ).scrollTop();
										orgchartScrollLeft = $( '#orgchart' ).scrollLeft();

										var jsonDataString = JSON.stringify( jsonData );
										jsonDataString = jsonDataString.replace( /"name_inactive"/g, '"name"' );
										jsonData = JSON.parse( jsonDataString );
										setNodeHeight();
										createOrgChart( hideRootNodeFlag, 1 );
										fixHeightInJsonData();
										NameHiddenFlag = 0;
										$( '.node-title' ).css( 'font-size', '1.2em' );
										$( '.node-title' ).css( 'margin-bottom', '3.9em' );
										if ( DPicHiddenFlag == 1 ) {
											$( '.node-name' ).css( 'font-size', '1.4em' );
											$( '.node-name' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										if ( NameHiddenFlag == 1 && DPicHiddenFlag == 1 ) {

											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										break;
									case 'nodeDP':
										orgchartScrollTop = $( '#orgchart' ).scrollTop();
										orgchartScrollLeft = $( '#orgchart' ).scrollLeft();

										var jsonDataString = JSON.stringify( jsonData );
										jsonDataString = jsonDataString.replace( /"image_inactive"/g, '"image"' );
										jsonData = JSON.parse( jsonDataString );
										LegendSwitchedflag = 1;
										DPicHiddenFlag = 0;
										setNodeHeight();
										createOrgChart( hideRootNodeFlag, 1 );
										fixHeightInJsonData();
										$( '.node-name' ).css( 'font-size', '1.2em' );
										$( '.node-name' ).css( 'text-align', 'left' );
										$( '.node-title' ).css( 'text-align', 'left' );
										if ( NameHiddenFlag == 1 ) {
											$( '.node-title' ).css( 'font-size', '1.4em' );
											$( '.node-title' ).css( 'margin-bottom', '4.4em' );
										}
										if ( NameHiddenFlag == 1 && DPicHiddenFlag == 1 ) {

											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										break;
									case 'nodeDept':
										activeFields++;
										orgchartScrollTop = $( '#orgchart' ).scrollTop();
										orgchartScrollLeft = $( '#orgchart' ).scrollLeft();

										var jsonDataString = JSON.stringify( jsonData );
										jsonDataString = jsonDataString.replace( /"dept_inactive"/g, '"dept"' );
										jsonData = JSON.parse( jsonDataString );
										LegendSwitchedflag = 1;
										setNodeHeight();
										createOrgChart( hideRootNodeFlag, 1 );
										fixHeightInJsonData();
										if ( DPicHiddenFlag == 1 ) {
											$( '.node-name' ).css( 'font-size', '1.4em' );
											$( '.node-name' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										if ( NameHiddenFlag == 1 ) {
											$( '.node-title' ).css( 'font-size', '1.4em' );
											$( '.node-title' ).css( 'margin-bottom', '4.4em' );
										}
										if ( NameHiddenFlag == 1 && DPicHiddenFlag == 1 ) {

											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										break;
									case 'nodeGrade':
										activeFields++;
										orgchartScrollTop = $( '#orgchart' ).scrollTop();
										orgchartScrollLeft = $( '#orgchart' ).scrollLeft();

										var jsonDataString = JSON.stringify( jsonData );
										jsonDataString = jsonDataString.replace( /"grade_inactive"/g, '"grade"' );
										jsonData = JSON.parse( jsonDataString );
										LegendSwitchedflag = 1;
										setNodeHeight();
										createOrgChart( hideRootNodeFlag, 1 );
										fixHeightInJsonData();
										if ( DPicHiddenFlag == 1 ) {
											$( '.node-name' ).css( 'font-size', '1.4em' );
											$( '.node-name' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										if ( NameHiddenFlag == 1 ) {
											$( '.node-title' ).css( 'font-size', '1.4em' );
											$( '.node-title' ).css( 'margin-bottom', '4.4em' );
										}
										if ( NameHiddenFlag == 1 && DPicHiddenFlag == 1 ) {

											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										break;
									case 'nodeFunctn':
										activeFields++;
										orgchartScrollTop = $( '#orgchart' ).scrollTop();
										orgchartScrollLeft = $( '#orgchart' ).scrollLeft();

										var jsonDataString = JSON.stringify( jsonData );
										jsonDataString = jsonDataString.replace( /"functn_inactive"/g, '"functn"' );
										jsonData = JSON.parse( jsonDataString );
										LegendSwitchedflag = 1;
										setNodeHeight();
										createOrgChart( hideRootNodeFlag, 1 );
										fixHeightInJsonData();
										if ( DPicHiddenFlag == 1 ) {
											$( '.node-name' ).css( 'font-size', '1.4em' );
											$( '.node-name' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										if ( NameHiddenFlag == 1 ) {
											$( '.node-title' ).css( 'font-size', '1.4em' );
											$( '.node-title' ).css( 'margin-bottom', '4.4em' );
										}
										if ( NameHiddenFlag == 1 && DPicHiddenFlag == 1 ) {

											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										break;
									case 'nodeBusiness':
										activeFields++;
										orgchartScrollTop = $( '#orgchart' ).scrollTop();
										orgchartScrollLeft = $( '#orgchart' ).scrollLeft();

										var jsonDataString = JSON.stringify( jsonData );
										jsonDataString = jsonDataString.replace( /"business_inactive"/g, '"business"' );
										jsonData = JSON.parse( jsonDataString );
										LegendSwitchedflag = 1;
										setNodeHeight();
										createOrgChart( hideRootNodeFlag, 1 );
										fixHeightInJsonData();
										if ( DPicHiddenFlag == 1 ) {
											$( '.node-name' ).css( 'font-size', '1.4em' );
											$( '.node-name' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										if ( NameHiddenFlag == 1 ) {
											$( '.node-title' ).css( 'font-size', '1.4em' );
											$( '.node-title' ).css( 'margin-bottom', '4.4em' );
										}
										if ( NameHiddenFlag == 1 && DPicHiddenFlag == 1 ) {

											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										break;
									case 'nodeLocation':
										activeFields++;
										orgchartScrollTop = $( '#orgchart' ).scrollTop();
										orgchartScrollLeft = $( '#orgchart' ).scrollLeft();

										var jsonDataString = JSON.stringify( jsonData );
										jsonDataString = jsonDataString.replace( /"location_inactive"/g, '"location"' );
										jsonData = JSON.parse( jsonDataString );
										LegendSwitchedflag = 1;
										setNodeHeight();
										createOrgChart( hideRootNodeFlag, 1 );
										fixHeightInJsonData();
										if ( DPicHiddenFlag == 1 ) {
											$( '.node-name' ).css( 'font-size', '1.4em' );
											$( '.node-name' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										if ( NameHiddenFlag == 1 ) {
											$( '.node-title' ).css( 'font-size', '1.4em' );
											$( '.node-title' ).css( 'margin-bottom', '4.4em' );
										}
										if ( NameHiddenFlag == 1 && DPicHiddenFlag == 1 ) {

											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										break;
									case 'nodeCompany':
										activeFields++;
										orgchartScrollTop = $( '#orgchart' ).scrollTop();
										orgchartScrollLeft = $( '#orgchart' ).scrollLeft();

										var jsonDataString = JSON.stringify( jsonData );
										jsonDataString = jsonDataString.replace( /"company_inactive"/g, '"company"' );
										jsonData = JSON.parse( jsonDataString );
										LegendSwitchedflag = 1;
										setNodeHeight();
										createOrgChart( hideRootNodeFlag, 1 );
										fixHeightInJsonData();
										if ( DPicHiddenFlag == 1 ) {
											$( '.node-name' ).css( 'font-size', '1.4em' );
											$( '.node-name' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										if ( NameHiddenFlag == 1 ) {
											$( '.node-title' ).css( 'font-size', '1.4em' );
											$( '.node-title' ).css( 'margin-bottom', '4.4em' );
										}
										if ( NameHiddenFlag == 1 && DPicHiddenFlag == 1 ) {

											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										break;
									case 'nodeAge':
										activeFields++;
										orgchartScrollTop = $( '#orgchart' ).scrollTop();
										orgchartScrollLeft = $( '#orgchart' ).scrollLeft();

										var jsonDataString = JSON.stringify( jsonData );
										jsonDataString = jsonDataString.replace( /"age_inactive"/g, '"age"' );
										jsonData = JSON.parse( jsonDataString );
										LegendSwitchedflag = 1;
										setNodeHeight();
										createOrgChart( hideRootNodeFlag, 1 );
										fixHeightInJsonData();
										if ( DPicHiddenFlag == 1 ) {
											$( '.node-name' ).css( 'font-size', '1.4em' );
											$( '.node-name' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										if ( NameHiddenFlag == 1 ) {
											$( '.node-title' ).css( 'font-size', '1.4em' );
											$( '.node-title' ).css( 'margin-bottom', '4.4em' );
										}
										if ( NameHiddenFlag == 1 && DPicHiddenFlag == 1 ) {

											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}

										$( "#orgchart" ).animate( {
											scrollLeft : orgchartScrollLeft,
											scrollTop : orgchartScrollTop
										}, 0 );

										break;
									case 'nodeDoret':
										activeFields++;
										orgchartScrollTop = $( '#orgchart' ).scrollTop();
										orgchartScrollLeft = $( '#orgchart' ).scrollLeft();

										var jsonDataString = JSON.stringify( jsonData );
										jsonDataString = jsonDataString.replace( /"doret_inactive"/g, '"doret"' );
										jsonData = JSON.parse( jsonDataString );
										LegendSwitchedflag = 1;
										setNodeHeight();
										createOrgChart( hideRootNodeFlag, 1 );
										fixHeightInJsonData();
										if ( DPicHiddenFlag == 1 ) {
											$( '.node-name' ).css( 'font-size', '1.4em' );
											$( '.node-name' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										if ( NameHiddenFlag == 1 ) {
											$( '.node-title' ).css( 'font-size', '1.4em' );
											$( '.node-title' ).css( 'margin-bottom', '4.4em' );
										}
										if ( NameHiddenFlag == 1 && DPicHiddenFlag == 1 ) {

											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										break;
									case 'listEno':
										$( "#thEno" ).fadeIn();
										$( 'td:nth-child(2)' ).fadeIn();
										break;
									case 'listPno':
										$( "#thPno" ).fadeIn();
										$( 'td:nth-child(4)' ).fadeIn();
										break;
									case 'listCompany':
										$( "#thCompany" ).fadeIn();
										$( 'td:nth-child(5)' ).fadeIn();
										break;
									case 'listFunctn':
										$( "#thFunctn" ).fadeIn();
										$( 'td:nth-child(6)' ).fadeIn();
										break;
									case 'listBusiness':
										$( "#thBusiness" ).fadeIn();
										$( 'td:nth-child(7)' ).fadeIn();
										break;
									case 'listDept':
										$( "#thDept" ).fadeIn();
										$( 'td:nth-child(8)' ).fadeIn();
										break;
									case 'listLocation':
										$( "#thLocation" ).fadeIn();
										$( 'td:nth-child(9)' ).fadeIn();
										break;
									case 'listGrade':
										$( "#thGrade" ).fadeIn();
										$( 'td:nth-child(10)' ).fadeIn();
										break;
									case 'listTenure':
										$( "#thTenure" ).fadeIn();
										$( 'td:nth-child(11)' ).fadeIn();
										break;
									case 'listExp':
										$( "#thExp" ).fadeIn();
										$( 'td:nth-child(12)' ).fadeIn();
										break;
									case 'listDIcount':
										$( "#thDIcount" ).fadeIn();
										$( 'td:nth-child(13)' ).fadeIn();
										break;
									case 'listAge':
										$( "#thAge" ).fadeIn();
										$( 'td:nth-child(14)' ).fadeIn();
										break;
									case 'listDateOfRetirement':
										$( "#thDateOfRetirement" ).fadeIn();
										$( 'td:nth-child(15)' ).fadeIn();
										break;
									case 'listPhone':
										$( "#thPhone" ).fadeIn();
										$( 'td:nth-child(16)' ).fadeIn();
										break;
									case 'listEmail':
										$( "#thEmail" ).fadeIn();
										$( 'td:nth-child(17)' ).fadeIn();
										break;
									default:
										//
								}
							} );
							$( 'input' ).on( 'ifUnchecked', function ( event ) {
								switch ( this.id ) {
									case 'nodeName':
										orgchartScrollTop = $( '#orgchart' ).scrollTop();
										orgchartScrollLeft = $( '#orgchart' ).scrollLeft();

										var jsonDataString = JSON.stringify( jsonData );
										jsonDataString = jsonDataString.replace( /"name"/g, '"name_inactive"' );
										jsonData = JSON.parse( jsonDataString );
										LegendSwitchedflag = 1;
										setNodeHeight();
										createOrgChart( hideRootNodeFlag, 1 );
										fixHeightInJsonData();
										$( '.node-title' ).css( 'font-size', '1.4em' );
										$( '.node-title' ).css( 'margin-bottom', '4.4em' );
										NameHiddenFlag = 1;
										if ( DPicHiddenFlag == 1 ) {
											$( '.node-name' ).css( 'font-size', '1.4em' );
											$( '.node-name' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										if ( NameHiddenFlag == 1 && DPicHiddenFlag == 1 ) {

											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
											$( '.node-title' ).css( 'font-size', '1.4em' );
										}
										break;
									case 'nodeDP':
										orgchartScrollTop = $( '#orgchart' ).scrollTop();
										orgchartScrollLeft = $( '#orgchart' ).scrollLeft();

										var jsonDataString = JSON.stringify( jsonData );
										jsonDataString = jsonDataString.replace( /"image"/g, '"image_inactive"' );
										jsonData = JSON.parse( jsonDataString );
										LegendSwitchedflag = 1;
										DPicHiddenFlag = 1;
										setNodeHeight();
										createOrgChart( hideRootNodeFlag, 1 );
										fixHeightInJsonData();
										$( '.node-name' ).css( 'font-size', '1.4em' );
										$( '.node-name' ).css( 'text-align', 'center' );
										$( '.node-title' ).css( 'text-align', 'center' );
										$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										if ( NameHiddenFlag == 1 ) {
											$( '.node-title' ).css( 'font-size', '1.4em' );
											$( '.node-title' ).css( 'margin-bottom', '4.4em' );
										}
										if ( NameHiddenFlag == 1 && DPicHiddenFlag == 1 ) {

											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										break;
									case 'nodeDept':
										activeFields--;
										orgchartScrollTop = $( '#orgchart' ).scrollTop();
										orgchartScrollLeft = $( '#orgchart' ).scrollLeft();

										var jsonDataString = JSON.stringify( jsonData );
										jsonDataString = jsonDataString.replace( /"dept"/g, '"dept_inactive"' );
										jsonData = JSON.parse( jsonDataString );
										LegendSwitchedflag = 1;
										setNodeHeight();
										createOrgChart( hideRootNodeFlag, 1 );
										fixHeightInJsonData();
										if ( DPicHiddenFlag == 1 ) {
											$( '.node-name' ).css( 'font-size', '1.4em' );
											$( '.node-name' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										if ( NameHiddenFlag == 1 ) {
											$( '.node-title' ).css( 'font-size', '1.4em' );
											$( '.node-title' ).css( 'margin-bottom', '4.4em' );
										}
										if ( NameHiddenFlag == 1 && DPicHiddenFlag == 1 ) {

											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										break;
									case 'nodeGrade':
										activeFields--;
										orgchartScrollTop = $( '#orgchart' ).scrollTop();
										orgchartScrollLeft = $( '#orgchart' ).scrollLeft();

										var jsonDataString = JSON.stringify( jsonData );
										jsonDataString = jsonDataString.replace( /"grade"/g, '"grade_inactive"' );
										jsonData = JSON.parse( jsonDataString );
										LegendSwitchedflag = 1;
										setNodeHeight();
										createOrgChart( hideRootNodeFlag, 1 );
										fixHeightInJsonData();
										if ( DPicHiddenFlag == 1 ) {
											$( '.node-name' ).css( 'font-size', '1.4em' );
											$( '.node-name' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										if ( NameHiddenFlag == 1 ) {
											$( '.node-title' ).css( 'font-size', '1.4em' );
											$( '.node-title' ).css( 'margin-bottom', '4.4em' );
										}
										if ( NameHiddenFlag == 1 && DPicHiddenFlag == 1 ) {

											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										break;
									case 'nodeFunctn':
										activeFields--;
										orgchartScrollTop = $( '#orgchart' ).scrollTop();
										orgchartScrollLeft = $( '#orgchart' ).scrollLeft();

										var jsonDataString = JSON.stringify( jsonData );
										jsonDataString = jsonDataString.replace( /"functn"/g, '"functn_inactive"' );
										jsonData = JSON.parse( jsonDataString );
										LegendSwitchedflag = 1;
										setNodeHeight();
										createOrgChart( hideRootNodeFlag, 1 );
										fixHeightInJsonData();
										if ( DPicHiddenFlag == 1 ) {
											$( '.node-name' ).css( 'font-size', '1.4em' );
											$( '.node-name' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										if ( NameHiddenFlag == 1 ) {
											$( '.node-title' ).css( 'font-size', '1.4em' );
											$( '.node-title' ).css( 'margin-bottom', '4.4em' );
										}
										if ( NameHiddenFlag == 1 && DPicHiddenFlag == 1 ) {

											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										break;
									case 'nodeBusiness':
										activeFields--;
										orgchartScrollTop = $( '#orgchart' ).scrollTop();
										orgchartScrollLeft = $( '#orgchart' ).scrollLeft();

										var jsonDataString = JSON.stringify( jsonData );
										jsonDataString = jsonDataString.replace( /"business"/g, '"business_inactive"' );
										jsonData = JSON.parse( jsonDataString );
										LegendSwitchedflag = 1;
										setNodeHeight();
										createOrgChart( hideRootNodeFlag, 1 );
										fixHeightInJsonData();
										if ( DPicHiddenFlag == 1 ) {
											$( '.node-name' ).css( 'font-size', '1.4em' );
											$( '.node-name' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										if ( NameHiddenFlag == 1 ) {
											$( '.node-title' ).css( 'font-size', '1.4em' );
											$( '.node-title' ).css( 'margin-bottom', '4.4em' );
										}
										if ( NameHiddenFlag == 1 && DPicHiddenFlag == 1 ) {

											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										break;
									case 'nodeLocation':
										activeFields--;
										orgchartScrollTop = $( '#orgchart' ).scrollTop();
										orgchartScrollLeft = $( '#orgchart' ).scrollLeft();

										var jsonDataString = JSON.stringify( jsonData );
										jsonDataString = jsonDataString.replace( /"location"/g, '"location_inactive"' );
										jsonData = JSON.parse( jsonDataString );
										LegendSwitchedflag = 1;
										setNodeHeight();
										createOrgChart( hideRootNodeFlag, 1 );
										fixHeightInJsonData();
										if ( DPicHiddenFlag == 1 ) {
											$( '.node-name' ).css( 'font-size', '1.4em' );
											$( '.node-name' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										if ( NameHiddenFlag == 1 ) {
											$( '.node-title' ).css( 'font-size', '1.4em' );
											$( '.node-title' ).css( 'margin-bottom', '4.4em' );
										}
										if ( NameHiddenFlag == 1 && DPicHiddenFlag == 1 ) {

											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										break;
									case 'nodeCompany':
										activeFields--;
										orgchartScrollTop = $( '#orgchart' ).scrollTop();
										orgchartScrollLeft = $( '#orgchart' ).scrollLeft();

										var jsonDataString = JSON.stringify( jsonData );
										jsonDataString = jsonDataString.replace( /"company"/g, '"company_inactive"' );
										jsonData = JSON.parse( jsonDataString );
										LegendSwitchedflag = 1;
										setNodeHeight();
										createOrgChart( hideRootNodeFlag, 1 );
										fixHeightInJsonData();
										if ( DPicHiddenFlag == 1 ) {
											$( '.node-name' ).css( 'font-size', '1.4em' );
											$( '.node-name' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										if ( NameHiddenFlag == 1 ) {
											$( '.node-title' ).css( 'font-size', '1.4em' );
											$( '.node-title' ).css( 'margin-bottom', '4.4em' );
										}
										if ( NameHiddenFlag == 1 && DPicHiddenFlag == 1 ) {

											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										break;
									case 'nodeAge':
										activeFields--;
										orgchartScrollTop = $( '#orgchart' ).scrollTop();
										orgchartScrollLeft = $( '#orgchart' ).scrollLeft();

										var jsonDataString = JSON.stringify( jsonData );
										jsonDataString = jsonDataString.replace( /"age"/g, '"age_inactive"' );
										jsonData = JSON.parse( jsonDataString );
										LegendSwitchedflag = 1;
										setNodeHeight();
										createOrgChart( hideRootNodeFlag, 1 );
										fixHeightInJsonData();
										if ( DPicHiddenFlag == 1 ) {
											$( '.node-name' ).css( 'font-size', '1.4em' );
											$( '.node-name' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										if ( NameHiddenFlag == 1 ) {
											$( '.node-title' ).css( 'font-size', '1.4em' );
											$( '.node-title' ).css( 'margin-bottom', '4.4em' );
										}
										if ( NameHiddenFlag == 1 && DPicHiddenFlag == 1 ) {

											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										break;
									case 'nodeDoret':
										activeFields--;
										orgchartScrollTop = $( '#orgchart' ).scrollTop();
										orgchartScrollLeft = $( '#orgchart' ).scrollLeft();

										var jsonDataString = JSON.stringify( jsonData );
										jsonDataString = jsonDataString.replace( /"doret"/g, '"doret_inactive"' );
										jsonData = JSON.parse( jsonDataString );
										LegendSwitchedflag = 1;
										setNodeHeight();
										createOrgChart( hideRootNodeFlag, 1 );
										fixHeightInJsonData();
										if ( DPicHiddenFlag == 1 ) {
											$( '.node-name' ).css( 'font-size', '1.4em' );
											$( '.node-name' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'text-align', 'center' );
											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										if ( NameHiddenFlag == 1 ) {
											$( '.node-title' ).css( 'font-size', '1.4em' );
											$( '.node-title' ).css( 'margin-bottom', '4.4em' );
										}
										if ( NameHiddenFlag == 1 && DPicHiddenFlag == 1 ) {

											$( '.node-title' ).css( 'margin-bottom', '0.1em' );
										}
										break;
									case 'listEno':
										$( "#thEno" ).fadeOut();
										$( 'td:nth-child(2)' ).fadeOut();
										break;
									case 'listPno':
										$( "#thPno" ).fadeOut();
										$( 'td:nth-child(4)' ).fadeOut();
										break;
									case 'listCompany':
										$( "#thCompany" ).fadeOut();
										$( 'td:nth-child(5)' ).fadeOut();
										break;
									case 'listFunctn':
										$( "#thFunctn" ).fadeOut();
										$( 'td:nth-child(6)' ).fadeOut();
										break;
									case 'listBusiness':
										$( "#thBusiness" ).fadeOut();
										$( 'td:nth-child(7)' ).fadeOut();
										break;
									case 'listDept':
										$( "#thDept" ).fadeOut();
										$( 'td:nth-child(8)' ).fadeOut();
										break;
									case 'listLocation':
										$( "#thLocation" ).fadeOut();
										$( 'td:nth-child(9)' ).fadeOut();
										break;
									case 'listGrade':
										$( "#thGrade" ).fadeOut();
										$( 'td:nth-child(10)' ).fadeOut();
										break;
									case 'listTenure':
										$( "#thTenure" ).fadeOut();
										$( 'td:nth-child(11)' ).fadeOut();
										break;
									case 'listExp':
										$( "#thExp" ).fadeOut();
										$( 'td:nth-child(12)' ).fadeOut();
										break;
									case 'listDIcount':
										$( "#thDIcount" ).fadeOut();
										$( 'td:nth-child(13)' ).fadeOut();
										break;
									case 'listAge':
										$( "#thAge" ).fadeOut();
										$( 'td:nth-child(14)' ).fadeOut();
										break;
									case 'listDateOfRetirement':
										$( "#thDateOfRetirement" ).fadeOut();
										$( 'td:nth-child(15)' ).fadeOut();
										break;
									case 'listPhone':
										$( "#thPhone" ).fadeOut();
										$( 'td:nth-child(16)' ).fadeOut();
										break;
									case 'listEmail':
										$( "#thEmail" ).fadeOut();
										$( 'td:nth-child(17)' ).fadeOut();
										break;
									default:
										//
								}
							} );

						} );

		function createOrgChart ( hideRootNodeflag, positionFlag ) {

			$( "#divLoading" ).addClass( 'show' );
			$( '.dragscroll' ).jScrollPane();

			setDropLevelForMainNode( jsonData );

			var config = {
				chart : {
					container : "#orgchart",
					rootOrientation : 'NORTH',
					levelSeparation : 40,
					siblingSeparation : 20,
					subTeeSeparation : 40,
					padding : 450,
					nodeAlign : 'CENTER',
					hideRootNode : hideRootNodeflag,
					scrollbar : 'native',
					connectors : {
						type : 'step',
						style : {
							stroke : '#a3a3a3'
						}
					},
					node : {
						drawLineThrough : true,
						collapsable : false,
						HTMLclass : 'nodeCollapsible'
					},
					animateOnInit : false,
					animation : {
						nodeAnimation : "easeOutQuad",
						nodeSpeed : 500,
						connectorsAnimation : "easeInOut",
						connectorsSpeed : 500
					},
					callback : {
						onTreeLoaded : function () {

							if ( positionFlag === 0 ) {

								var el = $( "#main_node" );

								var elHeightOffset = el.offset().top;
								var elHeight = el.height();
								var chartHeight = $( "#orgchart" ).height();
								var heightOffset;

								if ( elHeight < chartHeight ) {
									heightOffset = elHeightOffset - ( ( chartHeight / 2 ) - ( elHeight / 2 ) );
								} else {
									heightOffset = elHeightOffset;
								}
								//
								var elWidthOffset = el.offset().left;
								var elWidth = el.width();
								var chartWidth = $( "#orgchart" ).width();
								var widthOffset;

								if ( elWidth < chartWidth ) {
									widthOffset = elWidthOffset - ( ( chartWidth / 2 ) - ( elWidth / 2 ) );
								} else {
									widthOffset = elWidthOffset;
								}

								$( '#orgchart' ).animate( {
									//scrollTop : 700,
									scrollLeft : widthOffset
								}, 500 );
								/*
								$( '#orgchartContainer' ).animate( {
									scrollTop : 700
								}, 500 );
								$( '#orgchartRootContainer' ).animate( {
									scrollTop : 700
								}, 500 );
								 */
								$( "#divLoading" ).removeClass( 'show' );

								if ( DPicHiddenFlag === 1 ) {
									$( '.node-name' ).css( 'font-size', '1.4em' );
									$( '.node-name' ).css( 'text-align', 'center' );
									$( '.node-title' ).css( 'text-align', 'center' );
									$( '.node-title' ).css( 'margin-bottom', '0.1em' );
								}

							} else if ( LegendSwitchedflag === 1 ) {

								var scrollRatio = ( $( '#orgchart' )[ 0 ].scrollHeight - $( '#orgchart' ).height() ) / $( '#orgchart' ).height();

								orgchartScrollTop = ( ( $( '#orgchart' )[ 0 ].scrollHeight - $( '#orgchart' ).height() ) ) / scrollRatio;

								$( "#orgchart" ).animate( {
									scrollLeft : orgchartScrollLeft,
									scrollTop : orgchartScrollTop
								}, 0 );

								$( "#divLoading" ).removeClass( 'show' );

							} else if ( LegendSwitchedflag === 0 ) {

								$( '#orgchart' ).zoomTo( {
									targetsize : 1,
									scalemode : "both",
									easing : "ease",
									duration : 1000,
									//nativeanimation: true,
									//preservescroll: false,
									root : $( '#orgchartContainer' )
								} );

								var el = $( "#" + activeID );

								var elHeightOffset = el.offset().top;
								var elHeight = el.height();
								var chartHeight = $( "#orgchart" ).height();
								var heightOffset;

								if ( elHeight < chartHeight ) {
									heightOffset = elHeightOffset - ( ( chartHeight / 2 ) - ( elHeight / 2 ) );
								} else {
									heightOffset = elHeightOffset;
								}

								var elWidthOffset = el.offset().left;
								var elWidth = el.width();
								var chartWidth = $( "#orgchart" ).width();
								var widthOffset;
								if ( elWidth < chartWidth ) {
									widthOffset = elWidthOffset - ( ( chartWidth / 2 ) - ( elWidth / 2 ) );
								} else {
									widthOffset = elWidthOffset;
								}

								$( '#orgchart' ).animate( {
									scrollTop : heightOffset,
									scrollLeft : widthOffset
								}, 0 );

								if ( DPicHiddenFlag === 1 ) {
									$( '.node-name' ).css( 'font-size', '1.4em' );
									$( '.node-name' ).css( 'text-align', 'center' );
									$( '.node-title' ).css( 'text-align', 'center' );
									$( '.node-title' ).css( 'margin-bottom', '0.1em' );
								}
								if ( NameHiddenFlag == 1 ) {
									$( '.node-title' ).css( 'font-size', '1.4em' );
									$( '.node-title' ).css( 'margin-bottom', '4.4em' );
								}
								if ( NameHiddenFlag == 1 && DPicHiddenFlag == 1 ) {

									$( '.node-title' ).css( 'margin-bottom', '0.1em' );
								}
								$( "#divLoading" ).removeClass( 'show' );

							}

							//$( ".node-name" ).css( "text-decoration", "underline" );

							$( ".node-name" ).css( "color", "rgb(11, 130, 216)" );
							$( ".node-name" ).css( "cursor", "pointer" );

						},
						onBeforeClickCollapseSwitch : function () {

							orgchartScrollTop = $( '#orgchart' ).scrollTop();
							orgchartScrollLeft = $( '#orgchart' ).scrollLeft();

							var HTMLid = this.nodeHTMLid;
							var collapseState = this.collapsed;

							activeID = HTMLid;

							if ( HTMLid != 'main_node' && collapseState == true ) {

								$( '#orgchart' ).zoomTo( {
									targetsize : 1,
									scalemode : "both",
									easing : "ease",
									duration : 400,
									//nativeanimation: true,
									//preservescroll: false,
									root : $( '#orgchartContainer' )
								} )

								LegendSwitchedflag = 0;

								addChildrenNodes( jsonData, jsonData, HTMLid, 'HTMLid' );

							}
						},
						onAfterClickCollapseSwitch : function () {
							var HTMLid = this.nodeHTMLid;
							var collapseState = this.collapsed;

							if ( HTMLid == 'main_node' ) {

								var el = $( "#main_node" );

								var elHeightOffset = el.offset().top;
								var elHeight = el.height();
								var chartHeight = $( "#orgchart" ).height();
								var heightOffset;

								if ( elHeight < chartHeight ) {
									heightOffset = elHeightOffset - ( ( chartHeight / 2 ) - ( elHeight / 2 ) );
								} else {
									heightOffset = elHeightOffset;
								}
								//
								var elWidthOffset = el.offset().left;
								var elWidth = el.width();
								var chartWidth = $( "#orgchart" ).width();
								var widthOffset;

								if ( elWidth < chartWidth ) {
									widthOffset = elWidthOffset - ( ( chartWidth / 2 ) - ( elWidth / 2 ) );
								} else {
									widthOffset = elWidthOffset;
								}

								$( '#orgchart' ).animate( {
									scrollTop : heightOffset,
									scrollLeft : widthOffset
								}, 0 );

							}

							changeNodeState( jsonData, collapseState, HTMLid, 'HTMLid' );

						}
					}
				},
				nodeStructure : jsonData
			};

			var orgchart = new Treant( config );

			$( "#orgchartLoading" ).hide();
			$( "#orgchartButtonsDiv" ).show();

			$( '.node' ).tooltipster( {
				animation : 'fade',
				side : 'bottom',
				theme : 'tooltipster-shadow',
				contentAsHTML : true
			} );

			$( '.node-name' ).click( function ( e ) {

				//var positionID = $( e.target ).parents( '.class' ).context.parentElement.id;

				alert( "Clicking Here will open up the clicked Emlpoyee's Org Chart." );

				//openSelectedNodeChart( jsonData, positionID, 'HTMLid' );

			} );

			$( '.node' ).mouseenter( function () {

				showTooltipData( jsonData, this.id, 'HTMLid' );

			} );

			$( '.node' ).mouseleave( function () {
				$( '#' + this.id ).tooltipster( 'close' );
			} );

		}

		function createPrintableOrgChart ( hideRootNodeflag, positionFlag, HTMLclass, fileType ) {

			$( "#orgchart" ).css( "height", "100em" );

			var dataString;
			var data;

			if ( HTMLclass === "nodePrintableLarge" || HTMLclass === "nodeWithPicPrintableLarge" ) {

				if ( activeFields === 0 ) {

					if ( DPicHiddenFlag === 1 ) {

						dataString = JSON.stringify( jsonData );
						dataString = dataString.replace( /#939393/g, "#000000" );
						dataString = dataString.replace( /node/g, "nodePrintableLarge" );

						data = JSON.parse( dataString );

					} else {

						dataString = JSON.stringify( jsonData );
						dataString = dataString.replace( /#939393/g, "#000000" );
						dataString = dataString.replace( /node/g, "nodeWithPicPrintableLarge" );

						data = JSON.parse( dataString );
					}

				} else {

					if ( DPicHiddenFlag === 1 ) {

						dataString = JSON.stringify( jsonData );
						dataString = dataString.replace( /#939393/g, "#000000" );
						dataString = dataString.replace( /nodeMatrixWithLink/g, "nodePrintableLargeSize" + ( activeFields + 1 ).toString() + "MatrixWithLink" );
						dataString = dataString.replace( /nodeVacantWithLink/g, "nodePrintableLargeSize" + ( activeFields + 1 ).toString() + "VacantWithLink" );
						dataString = dataString.replace( /nodeSec1WithLink/g, "nodePrintableLargeSize" + ( activeFields + 1 ).toString() + "Sec1WithLink" );
						dataString = dataString.replace( /nodeSec2WithLink/g, "nodePrintableLargeSize" + ( activeFields + 1 ).toString() + "Sec2WithLink" );
						dataString = dataString.replace( /nodeVacantSec1WithLink/g, "nodePrintableLargeSize" + ( activeFields + 1 ).toString() + "VacantSec1WithLink" );
						dataString = dataString.replace( /nodeVacantSec2WithLink/g, "nodePrintableLargeSize" + ( activeFields + 1 ).toString() + "VacantSec2WithLink" );
						dataString = dataString.replace( /nodeMatrixCollapsible/g, "nodePrintableLargeSize" + ( activeFields + 1 ).toString() + "MatrixCollapsible" );
						dataString = dataString.replace( /nodeVacantCollapsible/g, "nodePrintableLargeSize" + ( activeFields + 1 ).toString() + "VacantCollapsible" );
						dataString = dataString.replace( /nodeCollapsible/g, "nodePrintableLargeSize" + ( activeFields + 1 ).toString() + "Collapsible" );

					} else {

						dataString = JSON.stringify( jsonData );
						dataString = dataString.replace( /#939393/g, "#000000" );
						dataString = dataString.replace( /nodeMatrixWithLink/g, "nodeWithPicPrintableLargeSize" + ( activeFields + 1 ).toString() + "MatrixWithLink" );
						dataString = dataString.replace( /nodeVacantWithLink/g, "nodeWithPicPrintableLargeSize" + ( activeFields + 1 ).toString() + "VacantWithLink" );
						dataString = dataString.replace( /nodeSec1WithLink/g, "nodeWithPicPrintableLargeSize" + ( activeFields + 1 ).toString() + "Sec1WithLink" );
						dataString = dataString.replace( /nodeSec2WithLink/g, "nodeWithPicPrintableLargeSize" + ( activeFields + 1 ).toString() + "Sec2WithLink" );
						dataString = dataString.replace( /nodeVacantSec1WithLink/g, "nodeWithPicPrintableLargeSize" + ( activeFields + 1 ).toString() + "VacantSec1WithLink" );
						dataString = dataString.replace( /nodeVacantSec2WithLink/g, "nodeWithPicPrintableLargeSize" + ( activeFields + 1 ).toString() + "VacantSec2WithLink" );
						dataString = dataString.replace( /nodeMatrixCollapsible/g, "nodeWithPicPrintableLargeSize" + ( activeFields + 1 ).toString() + "MatrixCollapsible" );
						dataString = dataString.replace( /nodeVacantCollapsible/g, "nodeWithPicPrintableLargeSize" + ( activeFields + 1 ).toString() + "VacantCollapsible" );
						dataString = dataString.replace( /nodeCollapsible/g, "nodeWithPicPrintableLargeSize" + ( activeFields + 1 ).toString() + "Collapsible" );

					}

				}

				data = JSON.parse( dataString );

			} else {

				if ( activeFields === 0 ) {

					if ( DPicHiddenFlag === 1 ) {
						dataString = JSON.stringify( jsonData );
						dataString = dataString.replace( /#939393/g, "#000000" );
						dataString = dataString.replace( /node/g, "nodePrintable" );

						data = JSON.parse( dataString );

					} else {

						dataString = JSON.stringify( jsonData );
						dataString = dataString.replace( /#939393/g, "#000000" );
						dataString = dataString.replace( /node/g, "nodeWithPicPrintable" );

						data = JSON.parse( dataString );
					}
				} else {

					if ( DPicHiddenFlag === 1 ) {

						dataString = JSON.stringify( jsonData );
						dataString = dataString.replace( /#939393/g, "#000000" );
						dataString = dataString.replace( /nodeMatrixWithLink/g, "nodePrintableSize" + ( activeFields + 1 ).toString() + "MatrixWithLink" );
						dataString = dataString.replace( /nodeVacantWithLink/g, "nodePrintableSize" + ( activeFields + 1 ).toString() + "VacantWithLink" );
						dataString = dataString.replace( /nodeSec1WithLink/g, "nodePrintableSize" + ( activeFields + 1 ).toString() + "Sec1WithLink" );
						dataString = dataString.replace( /nodeSec2WithLink/g, "nodePrintableSize" + ( activeFields + 1 ).toString() + "Sec2WithLink" );
						dataString = dataString.replace( /nodeVacantSec1WithLink/g, "nodePrintableSize" + ( activeFields + 1 ).toString() + "VacantSec1WithLink" );
						dataString = dataString.replace( /nodeVacantSec2WithLink/g, "nodePrintableSize" + ( activeFields + 1 ).toString() + "VacantSec2WithLink" );
						dataString = dataString.replace( /nodeMatrixCollapsible/g, "nodePrintableSize" + ( activeFields + 1 ).toString() + "MatrixCollapsible" );
						dataString = dataString.replace( /nodeVacantCollapsible/g, "nodePrintableSize" + ( activeFields + 1 ).toString() + "VacantCollapsible" );
						dataString = dataString.replace( /nodeCollapsible/g, "nodePrintableSize" + ( activeFields + 1 ).toString() + "Collapsible" );
						data = JSON.parse( dataString );

					} else {

						dataString = JSON.stringify( jsonData );
						dataString = dataString.replace( /#939393/g, "#000000" );
						dataString = dataString.replace( /nodeMatrixWithLink/g, "nodeWithPicPrintableSize" + ( activeFields + 1 ).toString() + "MatrixWithLink" );
						dataString = dataString.replace( /nodeVacantWithLink/g, "nodeWithPicPrintableSize" + ( activeFields + 1 ).toString() + "VacantWithLink" );
						dataString = dataString.replace( /nodeSec1WithLink/g, "nodeWithPicPrintableSize" + ( activeFields + 1 ).toString() + "Sec1WithLink" );
						dataString = dataString.replace( /nodeSec2WithLink/g, "nodeWithPicPrintableSize" + ( activeFields + 1 ).toString() + "Sec2WithLink" );
						dataString = dataString.replace( /nodeVacantSec1WithLink/g, "nodeWithPicPrintableSize" + ( activeFields + 1 ).toString() + "VacantSec1WithLink" );
						dataString = dataString.replace( /nodeVacantSec2WithLink/g, "nodeWithPicPrintableSize" + ( activeFields + 1 ).toString() + "VacantSec2WithLink" );
						dataString = dataString.replace( /nodeMatrixCollapsible/g, "nodeWithPicPrintableSize" + ( activeFields + 1 ).toString() + "MatrixCollapsible" );
						dataString = dataString.replace( /nodeVacantCollapsible/g, "nodeWithPicPrintableSize" + ( activeFields + 1 ).toString() + "VacantCollapsible" );
						dataString = dataString.replace( /nodeCollapsible/g, "nodeWithPicPrintableSize" + ( activeFields + 1 ).toString() + "Collapsible" );
						data = JSON.parse( dataString );

					}

				}

			}

			deleteCollapsedNodes( data );
			adjustDropLevels( data );
			setPseudoNodes( data );
			//console.log( JSON.stringify( data ) );
			dropLevel = [
					0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
			];

			var config = {
				chart : {
					container : "#orgchart",
					rootOrientation : 'NORTH',
					levelSeparation : 30,
					siblingSeparation : 10,
					subTeeSeparation : 20,
					hideRootNode : hideRootNodeflag,
					padding : 12,
					scrollbar : 'native',
					connectors : {
						type : 'step',
						style : {
							'stroke' : '#000000',
							'stroke-width' : '1'
						}
					},
					node : {
						collapsable : false,
						HTMLclass : HTMLclass
					},
					callback : {
						onTreeLoaded : function () {

							$( '.node-title' ).css( 'margin-bottom', '0.1em' );

							if ( HTMLclass === "nodePrintableLarge" || HTMLclass === "nodeWithPicPrintableLarge" ) {

								if ( HTMLclass === "nodePrintableLarge" ) {

									if ( DPicHiddenFlag == 1 )
										$( '.node-name' ).css( 'margin-top', '0.9em' );

								}

								if ( NameHiddenFlag == 1 ) {

									$( '.node-title' ).css( 'font-size', '10pt' );
									$( '.node-title' ).css( 'margin-top', '1em' );

									if ( DPicHiddenFlag == 1 )
										$( '.node-title' ).css( 'display', 'inline-table' );

								}
							} else {

								if ( HTMLclass === "nodePrintableLarge" ) {

									if ( DPicHiddenFlag == 1 )
										$( '.node-name' ).css( 'margin-top', '0.9em' );

								}

								if ( NameHiddenFlag == 1 ) {

									$( '.node-title' ).css( 'font-size', '7.5pt' );
									$( '.node-title' ).css( 'margin-top', '1em' );

									if ( DPicHiddenFlag == 1 )
										$( '.node-title' ).css( 'display', 'inline-table' );

								}
							}

							var useWidth = $( '#orgchart' ).prop( 'scrollWidth' );
							getUserName( data );
							userTitle = $( '[id^=main_node]  .node-title' ).text();
							curDate = $.datepicker.formatDate( 'd M yy', new Date() );

							if ( fileType === 'JPEG' ) {

								logoBase64 = "data:image/png;base64,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";
										
								$( "#orgchart" ).prepend(
										"<div style='position: absolute; width: " +useWidth + "px;'><span style='font-family: Sintony, sans-serif;  top: 0.5%; font-size: 18px; margin-left: 150px; float: left;'><b><i class='fa fa-sitemap'></i> " + userName + "&nbsp;&nbsp;</b>|<b>&nbsp;&nbsp;"
												+ userTitle + "</b></span><span style='float: right ;margin-right: 150px;'><img src='"+logoBase64+"' style='width: 13em; height: 10.07em;'></span></div>" );
								$( "#orgchart" ).append(
										"<div style='font-family: Sintony, sans-serif; position: initial; width: " + useWidth + "px; bottom: 10%; margin-bottom: -18%; font-size: 18px;'><hr><p><span align='left' style='margin-left: 270px; float: left;'><p><b>Generated By: " + firstUserName + " | "
												+ curDate + "</b></p><p><b>CONFIDENTIAL: Not to be disclosed with anyone outside the organisation.</b></p></span></p><p><br><br></p><p><br><br></p><p><br><br></p></div>" );

								$( "#orgchart" ).css( "background-color", "rgba(255, 255, 255, 0)" );

								document.getElementById( 'orgchart' ).style.overflow = 'visible';

								setTimeout( function () {

									$( "#exportLoadingMessage" ).html( "Preparing Image.." );

									if ( $.browser.mozilla || $.browser.msie || $.browser.safari ) {

										var svgElements = $( "#orgchart" ).find( 'svg' );
										//replace all svgs with a temp canvas
										svgElements.each( function () {
											var canvas, xml;

											// canvg doesn't cope very well with em font sizes so find the calculated size in pixels and replace it in the element.
											$.each( $( this ).find( '[style*=em]' ), function ( index, el ) {
												$( this ).css( 'font-size', getStyle( el, 'font-size' ) );
											} );

											canvas = document.createElement( "canvas" );
											canvas.className = "screenShotTempCanvas";

											//convert SVG into a XML string
											xml = ( new XMLSerializer() ).serializeToString( this );

											// Removing the name space as IE throws an error
											var start = xml.indexOf( "<svg" );
											var end = xml.lastIndexOf( "/svg>" );
											xml = xml.substring( start, end + 5 );
											xml = xml.replace( /xmlns=\"http:\/\/www\.w3\.org\/2000\/svg\"/, '' );
											xml = xml.replace( /xmlns:NS1=""/g, '' );
											xml = xml.replace( /NS1:xmlns:xlink=\"http:\/\/www\.w3\.org\/1999\/xlink\"/g, 'xmlns:xlink=\"http:\/\/www\.w3\.org\/1999\/xlink\"' );
											xml = xml.replace( /xmlns:xlink=\"http:\/\/www\.w3\.org\/1999\/xlink\" xlink:href/g, 'xlink:href' );

											//draw the SVG onto a canvas
											canvg( canvas, xml );
											$( canvas ).insertAfter( this );
											//hide the SVG element
											////this.className = "tempHide";
											$( this ).attr( 'class', 'tempHide' );
											$( this ).hide();
										} );
									}

									var useWidth = $( '#orgchart' ).prop( 'scrollWidth' ); //document.getElementById("primary").style.width;
									var useHeight = $( '#orgchart' ).prop( 'scrollHeight' ); //document.getElementById("primary").style.height;

									var scaleBy = 2.2;

									var w = useWidth;
									var h = useHeight;
									var scaledCanvas = document.createElement( 'canvas' );
									scaledCanvas.width = w * scaleBy;
									scaledCanvas.height = h * scaleBy
									var scaledContext = scaledCanvas.getContext( '2d' );
									scaledContext.scale( scaleBy, scaleBy );

									html2canvas( $( "#orgchart" ), {
										canvas : scaledCanvas,
										logging : false,
										onrendered : function ( canvas ) {

											var imgData = canvas.toDataURL( 'image/png' );
											download( imgData, "OrgChart_" + userName + "_" + curDate.replace( / /g, "" ) + ".jpg", "image/png" );

											document.getElementById( 'orgchart' ).style.overflow = 'auto';
											$( "#orgchart" ).css( "background-color", "#FFFFFF" );

											$( "#orgchart" ).css( "height", "630px" );

											setNodeHeight();
											createOrgChart( hideRootNodeFlag, 0 );
											fixHeightInJsonData();

											$( "#exportButtonsDiv" ).show();
											$( "#exportLoadingDiv" ).hide();
											$( "#downloadModal" ).modal( 'hide' );

										}
									} );

									if ( $.browser.mozilla || $.browser.msie || $.browser.safari ) {

										$( "#orgchart" ).find( '.screenShotTempCanvas' ).remove();
										$( "#orgchart" ).find( '.tempHide' ).show().removeClass( 'tempHide' );

									}

								}, 1500 );

							} else if ( fileType === 'PDF' ) {

								$( "#orgchart" ).css( "background-color", "rgba(255, 255, 255, 0)" );
								document.getElementById( 'orgchart' ).style.overflow = 'visible';

								setTimeout( function () {

									$( "#exportLoadingMessage" ).html( "Preparing PDF.." );

									makePdf();
									/*
									 if ( $.browser.mozilla || $.browser.msie || $.browser.safari ) {

									 var svgElements = $( "#orgchart" ).find( 'svg' );
									 //replace all svgs with a temp canvas
									 svgElements.each( function () {
									 var canvas, xml;

									 // canvg doesn't cope very well with em font sizes so find the calculated size in pixels and replace it in the element.
									 $.each( $( this ).find( '[style*=em]' ), function ( index, el ) {
									 $( this ).css( 'font-size', getStyle( el, 'font-size' ) );
									 } );

									 canvas = document.createElement( "canvas" );
									 canvas.className = "screenShotTempCanvas";

									 //convert SVG into a XML string
									 xml = ( new XMLSerializer() ).serializeToString( this );

									 // Removing the name space as IE throws an error
									 var start = xml.indexOf( "<svg" );
									 var end = xml.lastIndexOf( "/svg>" );
									 xml = xml.substring( start, end + 5 );
									 xml = xml.replace( /xmlns=\"http:\/\/www\.w3\.org\/2000\/svg\"/, '' );
									 xml = xml.replace( /xmlns:NS1=""/g, '' );
									 xml = xml.replace( /NS1:xmlns:xlink=\"http:\/\/www\.w3\.org\/1999\/xlink\"/g, 'xmlns:xlink=\"http:\/\/www\.w3\.org\/1999\/xlink\"' );
									 xml = xml.replace( /xmlns:xlink=\"http:\/\/www\.w3\.org\/1999\/xlink\" xlink:href/g, 'xlink:href' );

									 //draw the SVG onto a canvas
									 canvg( canvas, xml );
									 $( canvas ).insertAfter( this );
									 //hide the SVG element
									 ////this.className = "tempHide";
									 $( this ).attr( 'class', 'tempHide' );
									 $( this ).hide();
									 } );
									 }

									 var useWidth = $( '#orgchart' ).prop( 'scrollWidth' ); //document.getElementById("primary").style.width;
									 var useHeight = $( '#orgchart' ).prop( 'scrollHeight' ); //document.getElementById("primary").style.height;

									 var scaleBy = 2.2;

									 var w = useWidth;
									 var h = useHeight;
									 var scaledCanvas = document.createElement( 'canvas' );
									 scaledCanvas.width = w * scaleBy;
									 scaledCanvas.height = h * scaleBy;
									 var scaledContext = scaledCanvas.getContext( '2d' );
									 scaledContext.scale( scaleBy, scaleBy );

									 html2canvas( $( "#orgchart" ), {
									 canvas : scaledCanvas,
									 logging : false,
									 onrendered : function ( canvas ) {

									 var imgData = canvas.toDataURL( 'image/png' );

									 var doc = new jsPDF( "landscape", "mm", "a4" );
									 var width = doc.internal.pageSize.width;
									 var height = width / ratio;

									 if ( height > doc.internal.pageSize.height ) {

									 height = doc.internal.pageSize.height;
									 width = ratio * height;

									 }
									 var x;

									 if ( width < doc.internal.pageSize.width ) {
									 x = ( doc.internal.pageSize.width - width ) / 2;
									 } else {
									 x = 0;
									 }

									 doc.addImage( imgData, 'PNG', x, 0, width, height, '', 'FAST' ); //'FAST', 'SLOW', 'MEDIUM', 'NONE'

									 if ( $.browser.safari ) {
									 doc.output( 'save', "OrgChart_" + userName + "_" + curDate.replace( / /g, "" ) + ".pdf" );
									 } else {
									 doc.save( "OrgChart_" + userName + "_" + curDate.replace( / /g, "" ) + ".pdf" );
									 }
									 document.getElementById( 'orgchart' ).style.overflow = 'auto';
									 $( "#orgchart" ).css( "background-color", "#FFFFFF" );

									 $( "#orgchart" ).css( "height", "630px" );

									 setNodeHeight();
									 createOrgChart( hideRootNodeFlag, 0 );
									 fixHeightInJsonData();

									 $( "#exportButtonsDiv" ).show();
									 $( "#exportLoadingDiv" ).hide();
									 $( "#downloadModal" ).modal( 'hide' );

									 }

									 } );

									 if ( $.browser.mozilla || $.browser.msie || $.browser.safari ) {

									 $( "#orgchart" ).find( '.screenShotTempCanvas' ).remove();
									 $( "#orgchart" ).find( '.tempHide' ).show().removeClass( 'tempHide' );

									 }
									 */
									document.getElementById( 'orgchart' ).style.overflow = 'auto';
									$( "#orgchart" ).css( "background-color", "#FFFFFF" );

									$( "#orgchart" ).css( "height", "630px" );

									setNodeHeight();
									createOrgChart( hideRootNodeFlag, 0 );
									fixHeightInJsonData();

									$( "#exportButtonsDiv" ).show();
									$( "#exportLoadingDiv" ).hide();
									$( "#downloadModal" ).modal( 'hide' );

								}, 2000 );

							} else if ( fileType === 'PPT' ) {

								$( "#orgchart" ).css( "background-color", "rgba(255, 255, 255, 0)" );
								document.getElementById( 'orgchart' ).style.overflow = 'visible';

								setTimeout( function () {

									$( "#exportLoadingMessage" ).html( "Preparing Powerpoint PPT.." );

									if ( $.browser.mozilla || $.browser.msie || $.browser.safari ) {

										var svgElements = $( "#orgchart" ).find( 'svg' );
										//replace all svgs with a temp canvas
										svgElements.each( function () {
											var canvas, xml;

											// canvg doesn't cope very well with em font sizes so find the calculated size in pixels and replace it in the element.
											$.each( $( this ).find( '[style*=em]' ), function ( index, el ) {
												$( this ).css( 'font-size', getStyle( el, 'font-size' ) );
											} );

											canvas = document.createElement( "canvas" );
											canvas.className = "screenShotTempCanvas";

											//convert SVG into a XML string
											xml = ( new XMLSerializer() ).serializeToString( this );

											// Removing the name space as IE throws an error
											var start = xml.indexOf( "<svg" );
											var end = xml.lastIndexOf( "/svg>" );
											xml = xml.substring( start, end + 5 );
											xml = xml.replace( /xmlns=\"http:\/\/www\.w3\.org\/2000\/svg\"/, '' );
											xml = xml.replace( /xmlns:NS1=""/g, '' );
											xml = xml.replace( /NS1:xmlns:xlink=\"http:\/\/www\.w3\.org\/1999\/xlink\"/g, 'xmlns:xlink=\"http:\/\/www\.w3\.org\/1999\/xlink\"' );
											xml = xml.replace( /xmlns:xlink=\"http:\/\/www\.w3\.org\/1999\/xlink\" xlink:href/g, 'xlink:href' );

											//draw the SVG onto a canvas
											canvg( canvas, xml );
											$( canvas ).insertAfter( this );
											//hide the SVG element
											////this.className = "tempHide";
											$( this ).attr( 'class', 'tempHide' );
											$( this ).hide();
										} );
									}

									var useWidth = $( '#orgchart' ).prop( 'scrollWidth' ); //document.getElementById("primary").style.width;
									var useHeight = $( '#orgchart' ).prop( 'scrollHeight' ); //document.getElementById("primary").style.height;

									var scaleBy = 3;

									var w = useWidth;
									var h = useHeight;
									var scaledCanvas = document.createElement( 'canvas' );
									scaledCanvas.width = w * scaleBy;
									scaledCanvas.height = h * scaleBy;
									var scaledContext = scaledCanvas.getContext( '2d' );
									scaledContext.scale( scaleBy, scaleBy );

									html2canvas( $( "#orgchart" ), {
										canvas : scaledCanvas,
										logging : false,
										onrendered : function ( canvas ) {

											var imgData = canvas.toDataURL( 'image/png' );

											var width = 100;
											var height = width / ratio;
											height = height * 2;

											if ( height > 100 ) {

												height = 100;
												width = ratio * height;
												width = width / 2;

											}

											var pptx = new PptxGenJS();
											var slide = pptx.addNewSlide();

											width = width.toString() + "%";
											height = height.toString() + "%";

											slide.addImage( {
												x : 0,
												y : 0,
												w : width,
												h : height,
												data : imgData
											} );
											pptx.save( "OrgChart_" + userName + "_" + curDate.replace( / /g, "" ) );

											document.getElementById( 'orgchart' ).style.overflow = 'auto';
											$( "#orgchart" ).css( "background-color", "#FFFFFF" );

											$( "#orgchart" ).css( "height", "630px" );

											setNodeHeight();
											createOrgChart( hideRootNodeFlag, 0 );
											fixHeightInJsonData();

											$( "#exportButtonsDiv" ).show();
											$( "#exportLoadingDiv" ).hide();
											$( "#downloadModal" ).modal( 'hide' );

										}
									} );

									if ( $.browser.mozilla || $.browser.msie || $.browser.safari ) {

										$( "#orgchart" ).find( '.screenShotTempCanvas' ).remove();
										$( "#orgchart" ).find( '.tempHide' ).show().removeClass( 'tempHide' );

									}

								}, 2000 );

							}

						}
					}
				},
				nodeStructure : data
			};

			var orgchart = new Treant( config );

		}
	</script>

	<script>
		function getStyle ( el, styleProp ) {
			var camelize = function ( str ) {
				return str.replace( /\-(\w)/g, function ( str, letter ) {
					return letter.toUpperCase();
				} );
			};

			if ( el.currentStyle ) {
				return el.currentStyle[ camelize( styleProp ) ];
			} else if ( document.defaultView && document.defaultView.getComputedStyle ) {
				return document.defaultView.getComputedStyle( el, null ).getPropertyValue( styleProp );
			} else {
				return el.style[ camelize( styleProp ) ];
			}
		}
	</script>

	<script>
		function changeNodeState ( obj, state, keyval, key ) {
			if ( !obj )
				return;
			if ( obj instanceof Array ) {
				for ( var i in obj ) {
					changeNodeState( obj[ i ], state, keyval, key );
				}
				return;
			}
			if ( obj[ key ] ) {
				if ( obj[ key ] == keyval ) {

					obj.collapsed = state;

				}
			}
			if ( ( typeof obj == "object" ) && ( obj !== null ) ) {
				var children = Object.keys( obj );
				if ( children.length > 0 ) {
					for ( i = 0; i < children.length; i++ ) {
						changeNodeState( obj[ children[ i ] ], state, keyval, key )
					}
				}
			}
			return;
		}
	</script>

	<script>
		function showTooltipData ( obj, keyval, key ) {
			if ( !obj )
				return;
			if ( obj instanceof Array ) {
				for ( var i in obj ) {
					showTooltipData( obj[ i ], keyval, key );
				}
				return;
			}
			if ( obj[ key ] ) {
				if ( obj[ key ] == keyval ) {

					var tooltipData = "";

					if ( obj.text[ "name" ] ) {
						tooltipData = "<b>Name: </b> " + obj.text[ "name" ];
					} else if ( obj.text[ "name_inactive" ] ) {
						tooltipData = "<b>Name: </b> " + obj.text[ "name_inactive" ];
					}

					if ( obj.text[ "title" ] ) {
						tooltipData = tooltipData + "<br /><b>Title: </b> " + obj.text[ "title" ];
					}

					if ( obj.text[ "dept" ] ) {
						tooltipData = tooltipData + "<br /><b>Dept: </b> " + obj.text[ "dept" ];
					} else if ( obj.text[ "dept_inactive" ] ) {
						tooltipData = tooltipData + "<br /><b>Dept: </b> " + obj.text[ "dept_inactive" ];
					}

					if ( obj[ "HTMLid2" ] ) {
						tooltipData = tooltipData + "<br /><b>Position No.: </b> " + obj[ "HTMLid2" ];
					} else {
						tooltipData = tooltipData + "<br /><b>Position No.: </b> " + obj[ "HTMLid" ];
					}

					if ( obj.text[ "grade" ] ) {
						tooltipData = tooltipData + "<br /><b>Grade: </b> " + obj.text[ "grade" ];
					} else if ( obj.text[ "grade_inactive" ] ) {
						tooltipData = tooltipData + "<br /><b>Grade: </b> " + obj.text[ "grade_inactive" ];
					}

					if ( obj.text[ "functn" ] ) {
						tooltipData = tooltipData + "<br /><b>Function: </b> " + obj.text[ "functn" ];
					} else if ( obj.text[ "functn_inactive" ] ) {
						tooltipData = tooltipData + "<br /><b>Function: </b> " + obj.text[ "functn_inactive" ];
					}

					if ( obj.text[ "business" ] ) {
						tooltipData = tooltipData + "<br /><b>Business: </b> " + obj.text[ "business" ];
					} else if ( obj.text[ "business_inactive" ] ) {
						tooltipData = tooltipData + "<br /><b>Business: </b> " + obj.text[ "business_inactive" ];
					}

					if ( obj.text[ "location" ] ) {
						tooltipData = tooltipData + "<br /><b>Location: </b> " + obj.text[ "location" ];
					} else if ( obj.text[ "location_inactive" ] ) {
						tooltipData = tooltipData + "<br /><b>Location: </b> " + obj.text[ "location_inactive" ];
					}

					if ( obj.text[ "company" ] ) {
						tooltipData = tooltipData + "<br /><b>Company: </b> " + obj.text[ "company" ];
					} else if ( obj.text[ "company_inactive" ] ) {
						tooltipData = tooltipData + "<br /><b>Company: </b> " + obj.text[ "company_inactive" ];
					}

					if ( obj.text[ "age" ] ) {
						tooltipData = tooltipData + "<br /><b>Age: </b> " + obj.text[ "age" ];
					} else if ( obj.text[ "age_inactive" ] ) {
						tooltipData = tooltipData + "<br /><b>Age: </b> " + obj.text[ "age_inactive" ];
					}
					if ( obj.text[ "doret" ] ) {
						tooltipData = tooltipData + "<br /><b>Date of Retirement: </b> " + obj.text[ "doret" ];
					} else if ( obj.text[ "doret_inactive" ] ) {
						tooltipData = tooltipData + "<br /><b>Date of Retirement: </b> " + obj.text[ "doret_inactive" ];
					}

					//console.log( tooltipData );

					$( '#' + keyval ).tooltipster( 'content', tooltipData ).tooltipster( 'open' );

				}
			}
			if ( ( typeof obj == "object" ) && ( obj !== null ) ) {
				var children = Object.keys( obj );
				if ( children.length > 0 ) {
					for ( i = 0; i < children.length; i++ ) {
						showTooltipData( obj[ children[ i ] ], keyval, key )
					}
				}
			}
			return;
		}
	</script>


	<script>
		function collapseAllNodes ( obj, key ) {
			if ( !obj )
				return;
			if ( obj instanceof Array ) {
				for ( var i in obj ) {
					collapseAllNodes( obj[ i ], key );
				}
				return;
			}
			if ( obj[ key ] ) {
				obj.collapsed = false;

			}
			if ( ( typeof obj == "object" ) && ( obj !== null ) ) {
				var children = Object.keys( obj );
				if ( children.length > 0 ) {
					for ( i = 0; i < children.length; i++ ) {
						collapseAllNodes( obj[ children[ i ] ], key )
					}
				}
			}
			return;
		}
	</script>

	<script>
		function replaceNode ( data, obj ) {
			if ( !data )
				return;
			if ( data instanceof Array ) {
				for ( var i in data ) {
					replaceNode( data[ i ], obj );
				}
				return;
			}
			if ( data[ 'HTMLid' ] ) {
				if ( data[ 'HTMLid' ] == obj[ 'HTMLid' ] ) {
					//data.stackChildren = true;
					//data.drawLineThrough = true;
					data.children = obj.children;

				}
			}

			if ( ( typeof data == "object" ) && ( data !== null ) ) {
				var children = Object.keys( data );
				if ( children.length > 0 ) {
					for ( i = 0; i < children.length; i++ ) {
						replaceNode( data[ children[ i ] ], obj )
					}
				}
			}
			return;
		}
	</script>

	<script>
		function getNodeCount ( obj ) {
			if ( !obj )
				return;
			if ( obj instanceof Array ) {
				for ( var i in obj ) {
					getNodeCount( obj[ i ] );
				}
				return;
			}
			if ( obj[ 'HTMLid' ] ) {

				currentNodeCount++;

			}
			if ( ( typeof obj == "object" ) && ( obj !== null ) ) {
				var children = Object.keys( obj );
				if ( children.length > 0 ) {
					for ( i = 0; i < children.length; i++ ) {
						getNodeCount( obj[ children[ i ] ] )
					}
				}
			}
			return;
		}
	</script>

	<script>
		function adjustDropLevels ( obj ) {
			if ( !obj )
				return;

			if ( obj[ 'name' ] ) {
				if ( obj.name === 'ALIASGHAR MOHAMMADEBRAHIMZADEH' ) {
					obj.name = 'ALIASGHAR M.';
				}
			}
			if ( obj instanceof Array ) {
				for ( var i in obj ) {
					adjustDropLevels( obj[ i ] );
				}
				return;
			}
			if ( ( obj[ 'HTMLid' ] || obj[ 'pseudo' ] ) && obj[ 'children' ] ) {

				if ( obj.HTMLid === 'dm' || obj.HTMLid === 'mm0' || obj.HTMLid === 'mm1' || obj.HTMLid === 'mm2' || obj.HTMLid === 'main_node' || obj.HTMLid === 'sec1' || obj.HTMLid === 'sec2' ) {

					/*
					if ( obj.HTMLid === 'main_node' && obj[ 'secFlag' ] ) {

						obj.childrenDropLevel = 2;

					}
					 */
					obj.childrenDropLevel = -1;

				}

				if ( obj.children.length > 7 ) { //2 prev val //then 5

					if ( dropLevel[ parseInt( obj.level ) + 2 ] === 0 ) {
						dropLevel[ parseInt( obj.level ) + 2 ]++;
					} else if ( dropLevel[ parseInt( obj.level ) + 2 ] === 1 ) {
						dropLevel[ parseInt( obj.level ) + 2 ]++;
					} else if ( dropLevel[ parseInt( obj.level ) + 2 ] === 2 ) {
						dropLevel[ parseInt( obj.level ) + 2 ] = dropLevel[ parseInt( obj.level ) + 2 ] - 2;
					}

					obj.childrenDropLevel = parseInt( dropLevel[ parseInt( obj.level ) + 2 ] );

					if ( obj.hasOwnProperty( "HTMLid" ) ) {
						if ( obj.HTMLid.indexOf( 'main_node' ) === -1 ) {

							var data = JSON.parse( JSON.stringify( jsonData ) );
							deleteCollapsedNodes( data );
							getChildrenCountForMain_Node( data );

							if ( mainnodeObjChildrenCount > 4 ) {

								obj.stackChildren = true;
							}

						}
					}
				}

			}

			if ( ( typeof obj == "object" ) && ( obj !== null ) ) {
				var children = Object.keys( obj );
				if ( children.length > 0 ) {
					for ( i = 0; i < children.length; i++ ) {
						adjustDropLevels( obj[ children[ i ] ] )
					}
				}
			}
			return;
		}
	</script>


	<script>
		function deleteCollapsedNodes ( obj ) {
			if ( !obj )
				return;

			if ( obj instanceof Array ) {
				for ( var i in obj ) {
					deleteCollapsedNodes( obj[ i ] );
				}
				return;
			}
			if ( obj[ 'HTMLid' ] && obj[ 'children' ] ) {

				if ( ( obj.collapsed === true || obj.collapsed === 'true' ) ) {

					delete obj.children;
					delete obj.level;
					delete obj.childrenDropLevel;
					delete obj.collapsable;
					delete obj.collapsed;

				}

			}

			if ( ( typeof obj == "object" ) && ( obj !== null ) ) {
				var children = Object.keys( obj );
				if ( children.length > 0 ) {
					for ( i = 0; i < children.length; i++ ) {
						deleteCollapsedNodes( obj[ children[ i ] ] )
					}
				}
			}
			return;
		}
	</script>



	<script>
		function setPseudoNodes ( obj ) {
			if ( !obj )
				return;

			if ( obj instanceof Array ) {
				for ( var i in obj ) {
					setPseudoNodes( obj[ i ] );
				}
				return;
			}

			if ( ( obj[ 'HTMLid' ] || obj[ 'pseudo' ] ) && obj[ 'children' ] ) {

				if ( obj.HTMLid === 'dm' || obj.HTMLid === 'mm0' || obj.HTMLid === 'mm1' || obj.HTMLid === 'mm2' || obj.HTMLid === 'main_node' || obj.HTMLid === 'sec1' || obj.HTMLid === 'sec2' ) {

				} else {

					if ( obj.children.length > 12 ) {

						if ( obj.hasOwnProperty( "HTMLid" ) ) {

							if ( obj.HTMLid.indexOf( 'main_node' ) === -1 ) {

								var psArr1 = [], psArr2 = [];
								var psObj1 = [], psObj2 = [];

								var objChildrenArr = [];

								var level = obj.level;

								var children = obj.children;
								for ( i = 0; i < children.length; i++ ) {

									if ( children[ i ][ 'children' ] ) {

										psArr1.push( children[ i ] );
									} else {

										psArr2.push( children[ i ] );
									}

								}

								if ( psArr2.length != 0 && psArr1.length != 0 ) {

									delete obj[ 'children' ];

									psObj1[ 'pseudo' ] = true;
									psObj1[ 'level' ] = level;
									psObj1[ 'children' ] = psArr1;

									psObj2[ 'pseudo' ] = true;
									psObj2[ 'level' ] = level;
									psObj2[ 'stackChildren' ] = true;
									psObj2[ 'children' ] = psArr2;

									objChildrenArr.push( psObj1 );
									objChildrenArr.push( psObj2 );

									obj[ 'children' ] = objChildrenArr;
								}

							}
						} else if ( obj[ 'pseudo' ] ) {
							if ( !obj.hasOwnProperty( 'mainNodePsChild' ) ) {

								var psArr1 = [], psArr2 = [];
								var psObj1 = [], psObj2 = [];

								var objChildrenArr = [];

								var level = obj.level;

								var children = obj.children;
								for ( i = 0; i < children.length; i++ ) {

									if ( children[ i ][ 'children' ] ) {

										psArr1.push( children[ i ] );
									} else {

										psArr2.push( children[ i ] );
									}

								}

								if ( psArr2.length != 0 && psArr1.length != 0 ) {

									delete obj[ 'children' ];

									psObj1[ 'pseudo' ] = true;
									psObj1[ 'level' ] = level;
									psObj1[ 'children' ] = psArr1;

									psObj2[ 'pseudo' ] = true;
									psObj2[ 'level' ] = level;
									psObj2[ 'stackChildren' ] = true;
									psObj2[ 'children' ] = psArr2;

									objChildrenArr.push( psObj1 );
									objChildrenArr.push( psObj2 );

									obj[ 'children' ] = objChildrenArr;
								}
							}
						}

					}

				}

			}

			if ( ( typeof obj == "object" ) && ( obj !== null ) ) {
				var children = Object.keys( obj );
				if ( children.length > 0 ) {
					for ( i = 0; i < children.length; i++ ) {
						setPseudoNodes( obj[ children[ i ] ] )
					}
				}
			}
			return;
		}
	</script>

	<script>
		function getUserName ( obj ) {
			if ( !obj )
				return;
			if ( obj instanceof Array ) {
				for ( var i in obj ) {
					getUserName( obj[ i ] );
				}
				return;
			}
			if ( obj[ 'HTMLid' ] ) {
				if ( obj.HTMLid.indexOf( 'main_node' ) > -1 ) {
					if ( obj.text[ 'name' ] ) {
						userName = obj.text.name;
					} else {
						userName = obj.text.name_inactive;
					}
				}
			}

			if ( ( typeof obj == "object" ) && ( obj !== null ) ) {
				var children = Object.keys( obj );
				if ( children.length > 0 ) {
					for ( i = 0; i < children.length; i++ ) {
						getUserName( obj[ children[ i ] ] )
					}
				}
			}
			return;
		}
	</script>

	<script>
		function setDropLevelForMainNode ( obj ) {
			if ( !obj )
				return;
			if ( obj instanceof Array ) {
				for ( var i in obj ) {
					setDropLevelForMainNode( obj[ i ] );
				}
				return;
			}
			if ( obj[ 'HTMLid' ] ) {
				if ( obj.HTMLid.indexOf( 'main_node' ) > -1 ) {
					if ( obj[ 'childrenDropLevel' ] )
						obj.childrenDropLevel = '2';
				}
			}

			if ( ( typeof obj == "object" ) && ( obj !== null ) ) {
				var children = Object.keys( obj );
				if ( children.length > 0 ) {
					for ( i = 0; i < children.length; i++ ) {
						setDropLevelForMainNode( obj[ children[ i ] ] )
					}
				}
			}
			return;
		}
	</script>

	<script>
		function setValuesForAllMajorNodes ( obj ) {
			if ( !obj )
				return;
			if ( obj instanceof Array ) {
				for ( var i in obj ) {
					setValuesForAllMajorNodes( obj[ i ] );
				}
				return;
			}
			if ( obj[ 'HTMLid' ] ) {

				if ( obj.HTMLid.indexOf( 'dm' ) > -1 ) {

					dmObj = JSON.parse( JSON.stringify( obj ) ); //For cloning, and not just refering the same json object with new variable name
					delete dmObj.children;

				} else if ( obj.HTMLid.indexOf( 'main_node' ) > -1 ) {

					mainnodeObj = obj;

				} else if ( obj.HTMLid.indexOf( 'sec1' ) > -1 || obj.HTMLid.indexOf( 'sec2' ) > -1 ) {

					secArr.push( obj );

				} else if ( obj.HTMLid.indexOf( 'mm0' ) > -1 || obj.HTMLid.indexOf( 'mm1' ) > -1 || obj.HTMLid.indexOf( 'mm2' ) > -1 ) {

					mmArr.push( obj );

				}
			}

			if ( ( typeof obj == "object" ) && ( obj !== null ) ) {
				var children = Object.keys( obj );
				if ( children.length > 0 ) {
					for ( i = 0; i < children.length; i++ ) {
						setValuesForAllMajorNodes( obj[ children[ i ] ] )
					}
				}
			}
			return;
		}
	</script>



	<script>
		function getChildrenCountForMain_Node ( obj ) {
			if ( !obj )
				return;
			if ( obj instanceof Array ) {
				for ( var i in obj ) {
					getChildrenCountForMain_Node( obj[ i ] );
				}
				return;
			}
			if ( obj[ 'HTMLid' ] ) {

				if ( obj.HTMLid.indexOf( 'dm' ) > -1 ) {

					dmObj = JSON.parse( JSON.stringify( obj ) ); //For cloning, and not just refering the same json object with new variable name
					delete dmObj.children;

				} else if ( obj.HTMLid.indexOf( 'main_node' ) > -1 ) {

					mainnodeObjChildrenCount = obj.children.length;

				}
			}

			if ( ( typeof obj == "object" ) && ( obj !== null ) ) {
				var children = Object.keys( obj );
				if ( children.length > 0 ) {
					for ( i = 0; i < children.length; i++ ) {
						getChildrenCountForMain_Node( obj[ children[ i ] ] )
					}
				}
			}
			return;
		}
	</script>

	<script>
		function setNodeHeight () {
			switch ( activeFields ) {
				case 0:
					var dataString = JSON.stringify( jsonData );
					if ( DPicHiddenFlag === 1 ) {
						dataString = dataString.replace( /nodeNoPicMatrixWithLinkSize2/g, "nodeNoPicMatrixWithLink" );
						dataString = dataString.replace( /nodeNoPicVacantWithLinkSize2/g, "nodeNoPicVacantWithLink" );
						dataString = dataString.replace( /nodeNoPicSec1WithLinkSize2/g, "nodeNoPicSec1WithLink" );
						dataString = dataString.replace( /nodeNoPicSec2WithLinkSize2/g, "nodeNoPicSec2WithLink" );
						dataString = dataString.replace( /nodeNoPicVacantSec1WithLinkSize2/g, "nodeNoPicVacantSec1WithLink" );
						dataString = dataString.replace( /nodeNoPicVacantSec2WithLinkSize2/g, "nodeNoPicVacantSec2WithLink" );
						dataString = dataString.replace( /nodeNoPicMatrixCollapsibleSize2/g, "nodeNoPicMatrixCollapsible" );
						dataString = dataString.replace( /nodeNoPicVacantCollapsibleSize2/g, "nodeNoPicVacantCollapsible" );
						dataString = dataString.replace( /nodeNoPicCollapsibleSize2/g, "nodeNoPicCollapsible" );

						dataString = dataString.replace( /nodeMatrixWithLink/g, "nodeNoPicMatrixWithLink" );
						dataString = dataString.replace( /nodeVacantWithLink/g, "nodeNoPicVacantWithLink" );
						dataString = dataString.replace( /nodeSec1WithLink/g, "nodeNoPicSec1WithLink" );
						dataString = dataString.replace( /nodeSec2WithLink/g, "nodeNoPicSec2WithLink" );
						dataString = dataString.replace( /nodeVacantSec1WithLink/g, "nodeNoPicVacantSec1WithLink" );
						dataString = dataString.replace( /nodeVacantSec2WithLink/g, "nodeNoPicVacantSec2WithLink" );
						dataString = dataString.replace( /nodeMatrixCollapsible/g, "nodeNoPicMatrixCollapsible" );
						dataString = dataString.replace( /nodeVacantCollapsible/g, "nodeNoPicVacantCollapsible" );
						dataString = dataString.replace( /nodeCollapsible/g, "nodeNoPicCollapsible" );

					} else {
						dataString = dataString.replace( /nodeNoPicMatrixWithLinkSize2/g, "nodeMatrixWithLink" );
						dataString = dataString.replace( /nodeNoPicVacantWithLinkSize2/g, "nodeVacantWithLink" );
						dataString = dataString.replace( /nodeNoPicSec1WithLinkSize2/g, "nodeSec1WithLink" );
						dataString = dataString.replace( /nodeNoPicSec2WithLinkSize2/g, "nodeSec2WithLink" );
						dataString = dataString.replace( /nodeNoPicVacantSec1WithLinkSize2/g, "nodeVacantSec1WithLink" );
						dataString = dataString.replace( /nodeNoPicVacantSec2WithLinkSize2/g, "nodeVacantSec2WithLink" );
						dataString = dataString.replace( /nodeNoPicMatrixCollapsibleSize2/g, "nodeMatrixCollapsible" );
						dataString = dataString.replace( /nodeNoPicVacantCollapsibleSize2/g, "nodeVacantCollapsible" );
						dataString = dataString.replace( /nodeNoPicCollapsibleSize2/g, "nodeCollapsible" );

						dataString = dataString.replace( /nodeMatrixWithLinkSize2/g, "nodeMatrixWithLink" );
						dataString = dataString.replace( /nodeVacantWithLinkSize2/g, "nodeVacantWithLink" );
						dataString = dataString.replace( /nodeSec1WithLinkSize2/g, "nodeSec1WithLink" );
						dataString = dataString.replace( /nodeSec2WithLinkSize2/g, "nodeSec2WithLink" );
						dataString = dataString.replace( /nodeVacantSec1WithLinkSize2/g, "nodeVacantSec1WithLink" );
						dataString = dataString.replace( /nodeVacantSec2WithLinkSize2/g, "nodeVacantSec2WithLink" );
						dataString = dataString.replace( /nodeMatrixCollapsibleSize2/g, "nodeMatrixCollapsible" );
						dataString = dataString.replace( /nodeVacantCollapsibleSize2/g, "nodeVacantCollapsible" );
						dataString = dataString.replace( /nodeCollapsibleSize2/g, "nodeCollapsible" );
					}

					jsonData = JSON.parse( dataString );

					break;
				case 1:
				case 2:
				case 3:
				case 4:
				case 5:
				case 6:
				case 7:
				case 8:
				case 9:
					var dataString = JSON.stringify( jsonData );
					if ( DPicHiddenFlag == 0 ) {
						dataString = dataString.replace( /nodeMatrixWithLink/g, "nodeMatrixWithLinkSize" + ( activeFields + 1 ).toString() );
						dataString = dataString.replace( /nodeVacantWithLink/g, "nodeVacantWithLinkSize" + ( activeFields + 1 ).toString() );
						dataString = dataString.replace( /nodeSec1WithLink/g, "nodeSec1WithLinkSize" + ( activeFields + 1 ).toString() );
						dataString = dataString.replace( /nodeSec2WithLink/g, "nodeSec2WithLinkSize" + ( activeFields + 1 ).toString() );
						dataString = dataString.replace( /nodeVacantSec1WithLink/g, "nodeVacantSec1WithLinkSize" + ( activeFields + 1 ).toString() );
						dataString = dataString.replace( /nodeVacantSec2WithLink/g, "nodeVacantSec2WithLinkSize" + ( activeFields + 1 ).toString() );
						dataString = dataString.replace( /nodeMatrixCollapsible/g, "nodeMatrixCollapsibleSize" + ( activeFields + 1 ).toString() );
						dataString = dataString.replace( /nodeVacantCollapsible/g, "nodeVacantCollapsibleSize" + ( activeFields + 1 ).toString() );
						dataString = dataString.replace( /nodeCollapsible/g, "nodeCollapsibleSize" + ( activeFields + 1 ).toString() );
						jsonData = JSON.parse( dataString );
					} else if ( DPicHiddenFlag == 1 ) {
						dataString = dataString.replace( /nodeMatrixWithLink/g, "nodeNoPicMatrixWithLinkSize" + ( activeFields + 1 ).toString() );
						dataString = dataString.replace( /nodeVacantWithLink/g, "nodeNoPicVacantWithLinkSize" + ( activeFields + 1 ).toString() );
						dataString = dataString.replace( /nodeSec1WithLink/g, "nodeNoPicSec1WithLinkSize" + ( activeFields + 1 ).toString() );
						dataString = dataString.replace( /nodeSec2WithLink/g, "nodeNoPicSec2WithLinkSize" + ( activeFields + 1 ).toString() );
						dataString = dataString.replace( /nodeVacantSec1WithLink/g, "nodeNoPicVacantSec1WithLinkSize" + ( activeFields + 1 ).toString() );
						dataString = dataString.replace( /nodeVacantSec2WithLink/g, "nodeNoPicVacantSec2WithLinkSize" + ( activeFields + 1 ).toString() );
						dataString = dataString.replace( /nodeMatrixCollapsible/g, "nodeNoPicMatrixCollapsibleSize" + ( activeFields + 1 ).toString() );
						dataString = dataString.replace( /nodeVacantCollapsible/g, "nodeNoPicVacantCollapsibleSize" + ( activeFields + 1 ).toString() );
						dataString = dataString.replace( /nodeCollapsible/g, "nodeNoPicCollapsibleSize" + ( activeFields + 1 ).toString() );
						jsonData = JSON.parse( dataString );
					}
					break;
			}
		}
	</script>

	<script>
		function fixHeightInJsonData () {

			var dataString = JSON.stringify( jsonData );

			dataString = dataString.replace( /nodeNoPicCollapsibleSize2/g, "nodeCollapsible" );
			dataString = dataString.replace( /nodeNoPicVacantCollapsibleSize2/g, "nodeVacantCollapsible" );
			dataString = dataString.replace( /nodeNoPicMatrixCollapsibleSize2/g, "nodeMatrixCollapsible" );
			dataString = dataString.replace( /nodeNoPicMatrixWithLinkSize2/g, "nodeMatrixWithLink" );
			dataString = dataString.replace( /nodeNoPicVacantWithLinkSize2/g, "nodeVacantWithLink" );
			dataString = dataString.replace( /nodeNoPicSec1WithLinkSize2/g, "nodeSec1WithLink" );
			dataString = dataString.replace( /nodeNoPicSec2WithLinkSize2/g, "nodeSec2WithLink" );
			dataString = dataString.replace( /nodeNoPicVacantSec1WithLinkSize2/g, "nodeVacantSec1WithLink" );
			dataString = dataString.replace( /nodeNoPicVacantSec2WithLinkSize2/g, "nodeVacantSec2WithLink" );

			dataString = dataString.replace( /nodeNoPicCollapsibleSize3/g, "nodeCollapsible" );
			dataString = dataString.replace( /nodeNoPicVacantCollapsibleSize3/g, "nodeVacantCollapsible" );
			dataString = dataString.replace( /nodeNoPicMatrixCollapsibleSize3/g, "nodeMatrixCollapsible" );
			dataString = dataString.replace( /nodeNoPicMatrixWithLinkSize3/g, "nodeMatrixWithLink" );
			dataString = dataString.replace( /nodeNoPicVacantWithLinkSize3/g, "nodeVacantWithLink" );
			dataString = dataString.replace( /nodeNoPicSec1WithLinkSize3/g, "nodeSec1WithLink" );
			dataString = dataString.replace( /nodeNoPicSec2WithLinkSize3/g, "nodeSec2WithLink" );
			dataString = dataString.replace( /nodeNoPicVacantSec1WithLinkSize3/g, "nodeVacantSec1WithLink" );
			dataString = dataString.replace( /nodeNoPicVacantSec2WithLinkSize3/g, "nodeVacantSec2WithLink" );

			dataString = dataString.replace( /nodeNoPicCollapsibleSize4/g, "nodeCollapsible" );
			dataString = dataString.replace( /nodeNoPicVacantCollapsibleSize4/g, "nodeVacantCollapsible" );
			dataString = dataString.replace( /nodeNoPicMatrixCollapsibleSize4/g, "nodeMatrixCollapsible" );
			dataString = dataString.replace( /nodeNoPicMatrixWithLinkSize4/g, "nodeMatrixWithLink" );
			dataString = dataString.replace( /nodeNoPicVacantWithLinkSize4/g, "nodeVacantWithLink" );
			dataString = dataString.replace( /nodeNoPicSec1WithLinkSize4/g, "nodeSec1WithLink" );
			dataString = dataString.replace( /nodeNoPicSec2WithLinkSize4/g, "nodeSec2WithLink" );
			dataString = dataString.replace( /nodeNoPicVacantSec1WithLinkSize4/g, "nodeVacantSec1WithLink" );
			dataString = dataString.replace( /nodeNoPicVacantSec2WithLinkSize4/g, "nodeVacantSec2WithLink" );

			dataString = dataString.replace( /nodeNoPicCollapsibleSize5/g, "nodeCollapsible" );
			dataString = dataString.replace( /nodeNoPicVacantCollapsibleSize5/g, "nodeVacantCollapsible" );
			dataString = dataString.replace( /nodeNoPicMatrixCollapsibleSize5/g, "nodeMatrixCollapsible" );
			dataString = dataString.replace( /nodeNoPicMatrixWithLinkSize5/g, "nodeMatrixWithLink" );
			dataString = dataString.replace( /nodeNoPicVacantWithLinkSize5/g, "nodeVacantWithLink" );
			dataString = dataString.replace( /nodeNoPicSec1WithLinkSize5/g, "nodeSec1WithLink" );
			dataString = dataString.replace( /nodeNoPicSec2WithLinkSize5/g, "nodeSec2WithLink" );
			dataString = dataString.replace( /nodeNoPicVacantSec1WithLinkSize5/g, "nodeVacantSec1WithLink" );
			dataString = dataString.replace( /nodeNoPicVacantSec2WithLinkSize5/g, "nodeVacantSec2WithLink" );

			dataString = dataString.replace( /nodeNoPicCollapsibleSize6/g, "nodeCollapsible" );
			dataString = dataString.replace( /nodeNoPicVacantCollapsibleSize6/g, "nodeVacantCollapsible" );
			dataString = dataString.replace( /nodeNoPicMatrixCollapsibleSize6/g, "nodeMatrixCollapsible" );
			dataString = dataString.replace( /nodeNoPicMatrixWithLinkSize6/g, "nodeMatrixWithLink" );
			dataString = dataString.replace( /nodeNoPicVacantWithLinkSize6/g, "nodeVacantWithLink" );
			dataString = dataString.replace( /nodeNoPicSec1WithLinkSize6/g, "nodeSec1WithLink" );
			dataString = dataString.replace( /nodeNoPicSec2WithLinkSize6/g, "nodeSec2WithLink" );
			dataString = dataString.replace( /nodeNoPicVacantSec1WithLinkSize6/g, "nodeVacantSec1WithLink" );
			dataString = dataString.replace( /nodeNoPicVacantSec2WithLinkSize6/g, "nodeVacantSec2WithLink" );

			dataString = dataString.replace( /nodeNoPicCollapsibleSize7/g, "nodeCollapsible" );
			dataString = dataString.replace( /nodeNoPicVacantCollapsibleSize7/g, "nodeVacantCollapsible" );
			dataString = dataString.replace( /nodeNoPicMatrixCollapsibleSize7/g, "nodeMatrixCollapsible" );
			dataString = dataString.replace( /nodeNoPicMatrixWithLinkSize7/g, "nodeMatrixWithLink" );
			dataString = dataString.replace( /nodeNoPicVacantWithLinkSize7/g, "nodeVacantWithLink" );
			dataString = dataString.replace( /nodeNoPicSec1WithLinkSize7/g, "nodeSec1WithLink" );
			dataString = dataString.replace( /nodeNoPicSec2WithLinkSize7/g, "nodeSec2WithLink" );
			dataString = dataString.replace( /nodeNoPicVacantSec1WithLinkSize7/g, "nodeVacantSec1WithLink" );
			dataString = dataString.replace( /nodeNoPicVacantSec2WithLinkSize7/g, "nodeVacantSec2WithLink" );
			;

			dataString = dataString.replace( /nodeNoPicCollapsibleSize8/g, "nodeCollapsible" );
			dataString = dataString.replace( /nodeNoPicVacantCollapsibleSize8/g, "nodeVacantCollapsible" );
			dataString = dataString.replace( /nodeNoPicMatrixCollapsibleSize8/g, "nodeMatrixCollapsible" );
			dataString = dataString.replace( /nodeNoPicMatrixWithLinkSize8/g, "nodeMatrixWithLink" );
			dataString = dataString.replace( /nodeNoPicVacantWithLinkSize8/g, "nodeVacantWithLink" );
			dataString = dataString.replace( /nodeNoPicSec1WithLinkSize8/g, "nodeSec1WithLink" );
			dataString = dataString.replace( /nodeNoPicSec2WithLinkSize8/g, "nodeSec2WithLink" );
			dataString = dataString.replace( /nodeNoPicVacantSec1WithLinkSize8/g, "nodeVacantSec1WithLink" );
			dataString = dataString.replace( /nodeNoPicVacantSec2WithLinkSize8/g, "nodeVacantSec2WithLink" );

			dataString = dataString.replace( /nodeNoPicCollapsibleSize9/g, "nodeCollapsible" );
			dataString = dataString.replace( /nodeNoPicVacantCollapsibleSize9/g, "nodeVacantCollapsible" );
			dataString = dataString.replace( /nodeNoPicMatrixCollapsibleSize9/g, "nodeMatrixCollapsible" );
			dataString = dataString.replace( /nodeNoPicMatrixWithLinkSize9/g, "nodeMatrixWithLink" );
			dataString = dataString.replace( /nodeNoPicVacantWithLinkSize9/g, "nodeVacantWithLink" );
			dataString = dataString.replace( /nodeNoPicSec1WithLinkSize9/g, "nodeSec1WithLink" );
			dataString = dataString.replace( /nodeNoPicSec2WithLinkSize9/g, "nodeSec2WithLink" );
			dataString = dataString.replace( /nodeNoPicVacantSec1WithLinkSize9/g, "nodeVacantSec1WithLink" );
			dataString = dataString.replace( /nodeNoPicVacantSec2WithLinkSize9/g, "nodeVacantSec2WithLink" );

			dataString = dataString.replace( /nodeNoPicCollapsible/g, "nodeCollapsible" );
			dataString = dataString.replace( /nodeNoPicVacantCollapsible/g, "nodeVacantCollapsible" );
			dataString = dataString.replace( /nodeNoPicMatrixCollapsible/g, "nodeMatrixCollapsible" );
			dataString = dataString.replace( /nodeNoPicMatrixWithLink/g, "nodeMatrixWithLink" )
			dataString = dataString.replace( /nodeNoPicVacantWithLink/g, "nodeVacantWithLink" );
			dataString = dataString.replace( /nodeNoPicSec1WithLink/g, "nodeSec1WithLink" );
			dataString = dataString.replace( /nodeNoPicSec2WithLink/g, "nodeSec2WithLink" );
			dataString = dataString.replace( /nodeNoPicVacantSec1WithLink/g, "nodeVacantSec1WithLink" );
			dataString = dataString.replace( /nodeNoPicVacantSec2WithLink/g, "nodeVacantSec2WithLink" );

			dataString = dataString.replace( /nodeCollapsibleSize2/g, "nodeCollapsible" );
			dataString = dataString.replace( /nodeVacantCollapsibleSize2/g, "nodeVacantCollapsible" );
			dataString = dataString.replace( /nodeMatrixCollapsibleSize2/g, "nodeMatrixCollapsible" );
			dataString = dataString.replace( /nodeMatrixWithLinkSize2/g, "nodeMatrixWithLink" );
			dataString = dataString.replace( /nodeVacantWithLinkSize2/g, "nodeVacantWithLink" );
			dataString = dataString.replace( /nodeSec1WithLinkSize2/g, "nodeSec1WithLink" );
			dataString = dataString.replace( /nodeSec2WithLinkSize2/g, "nodeSec2WithLink" );
			dataString = dataString.replace( /nodeVacantSec1WithLinkSize2/g, "nodeVacantSec1WithLink" );
			dataString = dataString.replace( /nodeVacantSec2WithLinkSize2/g, "nodeVacantSec2WithLink" );

			dataString = dataString.replace( /nodeCollapsibleSize3/g, "nodeCollapsible" );
			dataString = dataString.replace( /nodeVacantCollapsibleSize3/g, "nodeVacantCollapsible" );
			dataString = dataString.replace( /nodeMatrixCollapsibleSize3/g, "nodeMatrixCollapsible" );
			dataString = dataString.replace( /nodeMatrixWithLinkSize3/g, "nodeMatrixWithLink" );
			dataString = dataString.replace( /nodeVacantWithLinkSize3/g, "nodeVacantWithLink" );
			dataString = dataString.replace( /nodeSec1WithLinkSize3/g, "nodeSec1WithLink" );
			dataString = dataString.replace( /nodeSec2WithLinkSize3/g, "nodeSec2WithLink" );
			dataString = dataString.replace( /nodeVacantSec1WithLinkSize3/g, "nodeVacantSec1WithLink" );
			dataString = dataString.replace( /nodeVacantSec2WithLinkSize3/g, "nodeVacantSec2WithLink" );

			dataString = dataString.replace( /nodeCollapsibleSize4/g, "nodeCollapsible" );
			dataString = dataString.replace( /nodeVacantCollapsibleSize4/g, "nodeVacantCollapsible" );
			dataString = dataString.replace( /nodeMatrixCollapsibleSize4/g, "nodeMatrixCollapsible" );
			dataString = dataString.replace( /nodeMatrixWithLinkSize4/g, "nodeMatrixWithLink" );
			dataString = dataString.replace( /nodeVacantWithLinkSize4/g, "nodeVacantWithLink" );
			dataString = dataString.replace( /nodeSec1WithLinkSize4/g, "nodeSec1WithLink" );
			dataString = dataString.replace( /nodeSec2WithLinkSize4/g, "nodeSec2WithLink" );
			dataString = dataString.replace( /nodeVacantSec1WithLinkSize4/g, "nodeVacantSec1WithLink" );
			dataString = dataString.replace( /nodeVacantSec2WithLinkSize4/g, "nodeVacantSec2WithLink" );

			dataString = dataString.replace( /nodeCollapsibleSize5/g, "nodeCollapsible" );
			dataString = dataString.replace( /nodeVacantCollapsibleSize5/g, "nodeVacantCollapsible" );
			dataString = dataString.replace( /nodeMatrixCollapsibleSize5/g, "nodeMatrixCollapsible" );
			dataString = dataString.replace( /nodeMatrixWithLinkSize5/g, "nodeMatrixWithLink" );
			dataString = dataString.replace( /nodeVacantWithLinkSize5/g, "nodeVacantWithLink" );
			dataString = dataString.replace( /nodeSec1WithLinkSize5/g, "nodeSec1WithLink" );
			dataString = dataString.replace( /nodeSec2WithLinkSize5/g, "nodeSec2WithLink" );
			dataString = dataString.replace( /nodeVacantSec1WithLinkSize5/g, "nodeVacantSec1WithLink" );
			dataString = dataString.replace( /nodeVacantSec2WithLinkSize5/g, "nodeVacantSec2WithLink" );

			dataString = dataString.replace( /nodeCollapsibleSize6/g, "nodeCollapsible" );
			dataString = dataString.replace( /nodeVacantCollapsibleSize6/g, "nodeVacantCollapsible" );
			dataString = dataString.replace( /nodeMatrixCollapsibleSize6/g, "nodeMatrixCollapsible" );
			dataString = dataString.replace( /nodeMatrixWithLinkSize6/g, "nodeMatrixWithLink" );
			dataString = dataString.replace( /nodeVacantWithLinkSize6/g, "nodeVacantWithLink" );
			dataString = dataString.replace( /nodeSec1WithLinkSize6/g, "nodeSec1WithLink" );
			dataString = dataString.replace( /nodeSec2WithLinkSize6/g, "nodeSec2WithLink" );
			dataString = dataString.replace( /nodeVacantSec1WithLinkSize6/g, "nodeVacantSec1WithLink" )
			dataString = dataString.replace( /nodeVacantSec2WithLinkSize6/g, "nodeVacantSec2WithLink" );

			dataString = dataString.replace( /nodeCollapsibleSize7/g, "nodeCollapsible" );
			dataString = dataString.replace( /nodeVacantCollapsibleSize7/g, "nodeVacantCollapsible" );
			dataString = dataString.replace( /nodeMatrixCollapsibleSize7/g, "nodeMatrixCollapsible" );
			dataString = dataString.replace( /nodeMatrixWithLinkSize7/g, "nodeMatrixWithLink" );
			dataString = dataString.replace( /nodeVacantWithLinkSize7/g, "nodeVacantWithLink" );
			dataString = dataString.replace( /nodeSec1WithLinkSize7/g, "nodeSec1WithLink" );
			dataString = dataString.replace( /nodeSec2WithLinkSize7/g, "nodeSec2WithLink" );
			dataString = dataString.replace( /nodeVacantSec1WithLinkSize7/g, "nodeVacantSec1WithLink" );
			dataString = dataString.replace( /nodeVacantSec2WithLinkSize7/g, "nodeVacantSec2WithLink" );

			dataString = dataString.replace( /nodeCollapsibleSize8/g, "nodeCollapsible" );
			dataString = dataString.replace( /nodeVacantCollapsibleSize8/g, "nodeVacantCollapsible" );
			dataString = dataString.replace( /nodeMatrixCollapsibleSize8/g, "nodeMatrixCollapsible" );
			dataString = dataString.replace( /nodeMatrixWithLinkSize8/g, "nodeMatrixWithLink" );
			dataString = dataString.replace( /nodeVacantWithLinkSize8/g, "nodeVacantWithLink" );
			dataString = dataString.replace( /nodeSec1WithLinkSize8/g, "nodeSec1WithLink" );
			dataString = dataString.replace( /nodeSec2WithLinkSize8/g, "nodeSec2WithLink" );
			dataString = dataString.replace( /nodeVacantSec1WithLinkSize8/g, "nodeVacantSec1WithLink" )
			dataString = dataString.replace( /nodeVacantSec2WithLinkSize8/g, "nodeVacantSec2WithLink" );
			;

			dataString = dataString.replace( /nodeCollapsibleSize9/g, "nodeCollapsible" );
			dataString = dataString.replace( /nodeVacantCollapsibleSize9/g, "nodeVacantCollapsible" );
			dataString = dataString.replace( /nodeMatrixCollapsibleSize9/g, "nodeMatrixCollapsible" );
			dataString = dataString.replace( /nodeMatrixWithLinkSize9/g, "nodeMatrixWithLink" );
			dataString = dataString.replace( /nodeVacantWithLinkSize9/g, "nodeVacantWithLink" );
			dataString = dataString.replace( /nodeSec1WithLinkSize9/g, "nodeSec1WithLink" );
			dataString = dataString.replace( /nodeSec2WithLinkSize9/g, "nodeSec2WithLink" );
			dataString = dataString.replace( /nodeVacantSec1WithLinkSize9/g, "nodeVacantSec1WithLink" );
			dataString = dataString.replace( /nodeVacantSec2WithLinkSize9/g, "nodeVacantSec2WithLink" );

			jsonData = JSON.parse( dataString );

		}
	</script>

	<script>
		var makePdf = function () {

			var useWidth = $( '#orgchart' ).prop( 'scrollWidth' );
			var useHeight = $( '#orgchart' ).prop( 'scrollHeight' );

			var pdf;

			if ( useHeight > useWidth ) {

				pdf = new jsPDF( 'p', 'px', [
						useWidth, useHeight
				] );

			} else if ( useHeight <= useWidth ) {

				pdf = new jsPDF( 'l', 'px', [
						useHeight, useWidth
				] );
			}

			var c = pdf.canvas;

			var svgTags = document.querySelectorAll( '#orgchart svg' );
			for ( var i = 0; i < svgTags.length; i++ ) {
				var svgTag = svgTags[ i ];

				if ( useHeight > useWidth ) {

					canvg( c, svgTag.outerHTML, {
						scaleWidth : useWidth,
						scaleHeight : useHeight,
						offsetX : 0,
						offsetY : 0,
						ignoreMouse : true,
						ignoreAnimation : true,
						ignoreClear : true,
						ignoreDimensions : true
					} );

				} else if ( useHeight <= useWidth ) {

					canvg( c, svgTag.outerHTML, {
						scaleWidth : useHeight,
						scaleHeight : useWidth,
						offsetX : 0,
						offsetY : 0,
						ignoreMouse : true,
						ignoreAnimation : true,
						ignoreClear : true,
						ignoreDimensions : true
					} );
				}

			}

			html2pdf( window.document.getElementById( "orgchart" ), useWidth, useHeight, pdf, function ( pdf ) {
				pdf.output( 'dataurlnewwindow' );

				var file = pdf.output( 'blob' );
				var fd = new FormData(); // To carry on your data  
				fd.append( 'mypdf', file );

				var xhr = new XMLHttpRequest();
				xhr.open( 'POST', "testServlet", true );
				xhr.setRequestHeader( "Connection", "close" );
				xhr.responseType = 'blob';
				xhr.onreadystatechange = function () {
					if ( this.readyState == 4 && this.status == 200 ) {
						//console.log( this.response, typeof this.response );

						var data = this.response;
						var type = typeof this.response;

						var filename = 'OrgChart.pptx';

						var blob = new Blob( [
							data
						], {
							type : type
						} );

						if ( typeof window.navigator.msSaveBlob !== 'undefined' ) {
							// IE workaround for "HTML7007: One or more blob URLs were revoked by closing the blob for which they were created. These URLs will no longer resolve as the data backing the URL has been freed."
							window.navigator.msSaveBlob( blob, filename );
						} else {
							var URL = window.URL || window.webkitURL;
							var downloadUrl = URL.createObjectURL( blob );

							if ( filename ) {
								// use HTML5 a[download] attribute to specify filename
								var a = document.createElement( "a" );
								// safari doesn't support this yet
								if ( typeof a.download === 'undefined' ) {
									window.location = downloadUrl;
								} else {
									a.href = downloadUrl;
									a.download = filename;
									document.body.appendChild( a );
									a.click();
								}
							} else {
								window.location = downloadUrl;
							}

							setTimeout( function () {
								URL.revokeObjectURL( downloadUrl );
							}, 100 ); // cleanup

						}

						$( "#exportButtonsDiv" ).show();
						$( "#exportLoadingDiv" ).hide();
						$( "#downloadModal" ).modal( 'hide' );

					}
				}
				xhr.send( fd );

			} );

		};
	</script>

	<script>
		var getEditablePPT = function () {

			var data = JSON.parse( JSON.stringify( jsonData ) );

			getUserName( jsonData );
			userTitle = $( '[id^=main_node]  .node-title' ).html();
			curDate = $.datepicker.formatDate( 'd M yy', new Date() );
			var filename = "OrgChart_" + userName + "_" + curDate.replace( / /g, "" ) + fileFormat;

			mmArr.length = 0;
			secArr.length = 0;

			deleteCollapsedNodes( data );
			setValuesForAllMajorNodes( data );

			var headerString = userName + " | " + userTitle;
			var footerString = "Generated By: " + firstUserName + " | " + curDate;

			console.log( JSON.stringify( dmObj ) );
			console.log( JSON.stringify( mainnodeObj ) );
			console.log( JSON.stringify( mmArr ) );
			console.log( JSON.stringify( secArr ) );

			var fd = new FormData();
			fd.append( 'DMObjString', JSON.stringify( dmObj ) );
			fd.append( 'mainNodeObjString', JSON.stringify( mainnodeObj ) );
			fd.append( 'mmArrString', JSON.stringify( mmArr ) );
			fd.append( 'secArrString', JSON.stringify( secArr ) );
			fd.append( 'headerText', headerString );
			fd.append( 'footerText', footerString );
			fd.append( 'fileFormat', fileFormat );

			var xhr = new XMLHttpRequest();
			xhr.open( 'POST', "editablePPT", true );
			xhr.responseType = 'blob';
			xhr.onreadystatechange = function () {
				if ( this.readyState == 4 && this.status == 200 ) {
					//console.log( this.response, typeof this.response );

					var data = this.response;
					var type = typeof this.response;

					var blob = new Blob( [
						data
					], {
						type : type
					} );

					if ( typeof window.navigator.msSaveBlob !== 'undefined' ) {
						// IE workaround for "HTML7007: One or more blob URLs were revoked by closing the blob for which they were created. These URLs will no longer resolve as the data backing the URL has been freed."
						window.navigator.msSaveBlob( blob, filename );
					} else {
						var URL = window.URL || window.webkitURL;
						var downloadUrl = URL.createObjectURL( blob );

						if ( filename ) {
							// use HTML5 a[download] attribute to specify filename
							var a = document.createElement( "a" );
							// safari doesn't support this yet
							if ( typeof a.download === 'undefined' ) {
								window.location = downloadUrl;
							} else {
								a.href = downloadUrl;
								a.download = filename;
								document.body.appendChild( a );
								a.click();
							}
						} else {
							window.location = downloadUrl;
						}

						setTimeout( function () {
							URL.revokeObjectURL( downloadUrl );
						}, 100 ); // cleanup

					}

					$( "#exportButtonsDiv" ).show();
					$( "#exportLoadingDiv" ).hide();
					$( "#downloadModal" ).modal( 'hide' );

				}
			}
			xhr.send( fd );

		}
	</script>


</body>
</html>